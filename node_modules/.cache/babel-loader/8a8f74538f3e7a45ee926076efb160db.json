{"ast":null,"code":"import _objectSpread from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";var UserContext=/*#__PURE__*/React.createContext();export function useUser(){return useContext(UserContext);}export function UserProvider(_ref){var children=_ref.children;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),contacts=_useState2[0],setContacts=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),info=_useState4[0],setInfo=_useState4[1];var config={'headers':{'x-access-token':sessionStorage['config']}};useEffect(function(){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:getContacts().then(function(res){return setContacts(res);});case 1:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();},[setInfo]);function getContacts(){return _getContacts.apply(this,arguments);}function _getContacts(){_getContacts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.get(\"https://messagesapp1.herokuapp.com/api/logIn/\"+sessionStorage['id'],config);case 2:response=_context3.sent;setInfo({id:response.data._id,name:response.data.name,phone:response.data.phone,imageName:response.data.imageName,LastSeen:response.data.LastSeen});return _context3.abrupt(\"return\",response.data.contacts);case 5:case\"end\":return _context3.stop();}}},_callee3);}));return _getContacts.apply(this,arguments);}function getSearchContacts(str){getContacts().then(function(res){var SearchResult=res.filter(function(contact){return contact.name.includes(str)===true;});setContacts(SearchResult);});}var createContact=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(phone){var checkIfExists,response,contact,newContacts,UpdatedUser;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(phone===info.phone)){_context2.next=2;break;}return _context2.abrupt(\"return\",{status:'error',message:'cant Add yourself'});case 2:checkIfExists=contacts.filter(function(contact){return contact.phone===phone;});if(!(checkIfExists.length!==0)){_context2.next=5;break;}return _context2.abrupt(\"return\",{status:'error',message:'already exists'});case 5:_context2.prev=5;_context2.next=8;return axios.get(\"https://messagesapp1.herokuapp.com/api/logIn/getByPhone/\"+phone,config);case 8:response=_context2.sent;if(!(response.data!=='no such user')){_context2.next=24;break;}contact={id:response.data._id,phone:response.data.phone,name:response.data.name,imageName:response.data.imageName};newContacts=[].concat(_toConsumableArray(contacts),[contact]);setContacts(newContacts);UpdatedUser=_objectSpread(_objectSpread({},info),{},{contacts:newContacts});_context2.prev=14;_context2.next=17;return axios.put(\"https://messagesapp1.herokuapp.com/api/logIn/\"+sessionStorage['id'],UpdatedUser,{'headers':{'x-access-token':sessionStorage['config']}});case 17:_context2.next=22;break;case 19:_context2.prev=19;_context2.t0=_context2[\"catch\"](14);console.log(_context2.t0);case 22:_context2.next=25;break;case 24:return _context2.abrupt(\"return\",{status:'error',message:'user doesnt exist'});case 25:_context2.next=30;break;case 27:_context2.prev=27;_context2.t1=_context2[\"catch\"](5);console.log(_context2.t1);case 30:return _context2.abrupt(\"return\",{status:'ok'});case 31:case\"end\":return _context2.stop();}}},_callee2,null,[[5,27],[14,19]]);}));return function createContact(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(UserContext.Provider,{value:{setContacts:setContacts,setInfo:setInfo,info:info,config:config,contacts:contacts,createContact:createContact,getSearchContacts:getSearchContacts},children:children});}","map":{"version":3,"sources":["C:/Users/User/OneDrive/Desktop/whatsapp/myclient/src/contexts/userprovider.js"],"names":["React","useState","useEffect","useContext","axios","UserContext","createContext","useUser","UserProvider","children","contacts","setContacts","info","setInfo","config","sessionStorage","fetchData","getContacts","then","res","get","response","id","data","_id","name","phone","imageName","LastSeen","getSearchContacts","str","SearchResult","filter","contact","includes","createContact","status","message","checkIfExists","length","newContacts","UpdatedUser","put","console","log"],"mappings":"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","sourcesContent":["\r\nimport React, { useState ,useEffect, useContext} from 'react'\r\nimport axios from 'axios'\r\nconst UserContext = React.createContext()\r\n\r\nexport function useUser() {\r\n  return useContext(UserContext)\r\n}\r\n\r\nexport  function UserProvider({ children })\r\n{\r\n  const [contacts, setContacts] = useState([])\r\n  const [info,setInfo] =useState({})\r\n  const config= {'headers': {'x-access-token':sessionStorage['config']}}\r\n\r\n\r\n  \r\n   useEffect( () =>\r\n   {\r\n    async function fetchData() {\r\n\r\n    getContacts().then(res=> setContacts(res))\r\n    }\r\n\r\n    fetchData();\r\n\r\n   },[setInfo])\r\n\r\n   async function getContacts()\r\n   {\r\n    const response = await axios.get(\"https://messagesapp1.herokuapp.com/api/logIn/\"+sessionStorage['id'],config);\r\n    setInfo({id:response.data._id,name:response.data.name,phone:response.data.phone,imageName:response.data.imageName,LastSeen:response.data.LastSeen})\r\n    return(response.data.contacts)\r\n\r\n   }\r\n   \r\n\r\n  function getSearchContacts(str)\r\n  {\r\n    getContacts().then(res=>\r\n      {\r\n        let SearchResult =res.filter(contact=> contact.name.includes(str) === true)\r\n        setContacts(SearchResult)\r\n      })\r\n  }\r\n\r\n\r\n  const createContact = async(phone) =>\r\n  {\r\n\r\n\r\n\r\n    if(phone === info.phone)\r\n    {\r\n       return {status:'error',message:'cant Add yourself'};\r\n    }\r\n\r\n    let checkIfExists = contacts.filter(contact=> contact.phone === phone)\r\n\r\n    if(checkIfExists.length !== 0)\r\n    {\r\n      return {status:'error',message:'already exists'};\r\n    }\r\n\r\n    try{ \r\n\r\n      const response= await axios.get(\"https://messagesapp1.herokuapp.com/api/logIn/getByPhone/\" + phone,config)\r\n      if(response.data !== 'no such user')\r\n      {\r\n       const contact = {id:response.data._id,phone:response.data.phone,name:response.data.name,imageName:response.data.imageName}\r\n       let newContacts = [...contacts,contact]\r\n       setContacts(newContacts)\r\n       let UpdatedUser={...info,contacts:newContacts}\r\n       try{\r\n         await axios.put(\"https://messagesapp1.herokuapp.com/api/logIn/\" + sessionStorage['id'],UpdatedUser,{'headers': {'x-access-token':sessionStorage['config']}})\r\n       } catch(err){console.log(err)}\r\n      }\r\n      else return {status:'error',message:'user doesnt exist'};\r\n     \r\n    } catch(err){console.log(err)}\r\n\r\n    return {status:'ok'}\r\n  }\r\n\r\n\r\n\r\n  return (\r\n    <UserContext.Provider value={{setContacts,setInfo,info,config,contacts,createContact,getSearchContacts }}>\r\n      {children}\r\n    </UserContext.Provider>\r\n  )\r\n}"]},"metadata":{},"sourceType":"module"}
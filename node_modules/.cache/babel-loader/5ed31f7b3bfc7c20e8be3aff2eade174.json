{"ast":null,"code":"import _toConsumableArray from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import'../css/profiledetails.css';import axios from'axios';import{useUser}from'../contexts/userprovider';import{useConversations}from'../contexts/conversationsprovider';import{useSocket}from\"../contexts/socketprovider\";import{Avatar,IconButton,makeStyles}from'@material-ui/core';import ArrowBackIcon from'@material-ui/icons/ArrowBack';import AddAPhotoIcon from'@material-ui/icons/AddAPhoto';import EditIcon from'@material-ui/icons/Edit';import CheckIcon from'@material-ui/icons/Check';import InsertEmoticonIcon from'@material-ui/icons/InsertEmoticon';import Picker from'emoji-picker-react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles({root:{\"&:hover\":{backgroundColor:\"transparent\"}}});function ProfileDetails(_ref){var backToConversations=_ref.backToConversations;var _useUser=useUser(),info=_useUser.info,contacts=_useUser.contacts,setInfo=_useUser.setInfo,config=_useUser.config;var _useConversations=useConversations(),conversations=_useConversations.conversations,setConversations=_useConversations.setConversations;var _useSocket=useSocket(),socket=_useSocket.socket;var _useState=useState(info.imageName),_useState2=_slicedToArray(_useState,2),previewImage=_useState2[0],setPreviewImage=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),editNameFlag=_useState4[0],setEditNameFlag=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),editStatusFlag=_useState6[0],setEditStatusFlag=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),emojiFlag=_useState8[0],setEmojiFlag=_useState8[1];var _useState9=useState(info.name),_useState10=_slicedToArray(_useState9,2),Text=_useState10[0],setText=_useState10[1];var _useState11=useState(info.status),_useState12=_slicedToArray(_useState11,2),Status=_useState12[0],setStatus=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),statusEmojiFlag=_useState14[0],setStatusEmojiFlag=_useState14[1];var classes=useStyles();//add emoji to name\nvar _onEmojiClick=function onEmojiClick(event,emojiObject){setText(function(prevText){return prevText+emojiObject.emoji;});};//add emoji to status\nvar onStatusEmojiClick=function onStatusEmojiClick(event,emojiObject){setStatus(function(prevStatus){return prevStatus+emojiObject.emoji;});};//change profile picture  \nfunction handleFileUpload(_x){return _handleFileUpload.apply(this,arguments);}function _handleFileUpload(){_handleFileUpload=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var picturePath,data,response,obj,_response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:picturePath='';data=new FormData();data.append('file',e.target.files[0]);data.append(\"upload_preset\",\"whatsApp_clone\");data.append(\"cloud_name\",\"dsrgpqnyv\");_context.prev=5;_context.next=8;return axios.post(\"https://api.cloudinary.com/v1_1/dsrgpqnyv/image/upload\",data);case 8:response=_context.sent;picturePath=response.data.url;_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](5);console.log(_context.t0);case 15:obj={name:info.name,phone:info.phone,imageName:picturePath,contacts:contacts,LastSeen:info.lastSeen,Status:info.Status};_context.prev=16;_context.next=19;return axios.put(\"https://messagesapp1.herokuapp.com/api/logIn/\"+sessionStorage['id'],obj,config);case 19:_response=_context.sent;if(_response.data==='Updated')setInfo(obj);_context.next=26;break;case 23:_context.prev=23;_context.t1=_context[\"catch\"](16);console.log(_context.t1);case 26:setPreviewImage(window.URL.createObjectURL(e.target.files[0]));case 27:case\"end\":return _context.stop();}}},_callee,null,[[5,12],[16,23]]);}));return _handleFileUpload.apply(this,arguments);}function changeProfileName(){return _changeProfileName.apply(this,arguments);}function _changeProfileName(){_changeProfileName=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var obj,response,updateConv;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:obj={name:Text,phone:info.phone,imageName:info.imageName,contacts:contacts,LastSeen:info.LastSeen,Status:info.Status};_context3.prev=1;_context3.next=4;return axios.put(\"https://messagesapp1.herokuapp.com/api/logIn/\"+sessionStorage['id'],obj,config);case 4:response=_context3.sent;if(response.data==='Updated'){setInfo(obj);updateConv=[];conversations.map(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(conversation){var updateCon,newParticipants;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:updateCon='';if(conversation.Name===info.name){updateCon=_objectSpread(_objectSpread({},conversation),{},{Name:Text});}else updateCon=_objectSpread({},conversation);updateConv.push(updateCon);obj=_objectSpread(_objectSpread({},obj),{},{id:sessionStorage['id']});newParticipants=[].concat(_toConsumableArray(conversation.Participants),[obj]);updateCon=_objectSpread(_objectSpread({},updateCon),{},{Participants:newParticipants});delete updateCon._id;_context2.prev=7;_context2.next=10;return axios.put(\"https://messagesapp1.herokuapp.com/api/conversations/\"+conversation._id,updateCon,config);case 10:_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](7);console.log(_context2.t0);case 15:socket.current.emit('conversation-changed',conversation);case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[7,12]]);}));return function(_x2){return _ref2.apply(this,arguments);};}());setConversations(updateConv);}_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](1);console.log(_context3.t0);case 11:setEmojiFlag(false);setEditNameFlag(false);case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[1,8]]);}));return _changeProfileName.apply(this,arguments);}function changeProfileStatus(){return _changeProfileStatus.apply(this,arguments);}function _changeProfileStatus(){_changeProfileStatus=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var obj,response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:obj={name:info.name,phone:info.phone,imageName:info.imageName,contacts:contacts,LastSeen:info.LastSeen,Status:Status};_context4.prev=1;_context4.next=4;return axios.put(\"https://messagesapp1.herokuapp.com/api/logIn/\"+sessionStorage['id'],obj,config);case 4:response=_context4.sent;if(response.data==='Updated')setInfo(obj);_context4.next=11;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](1);console.log(_context4.t0);case 11:setStatusEmojiFlag(false);setEditStatusFlag(false);case 13:case\"end\":return _context4.stop();}}},_callee4,null,[[1,8]]);}));return _changeProfileStatus.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"show_details\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"profile_title\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"title_and_back_to_conversations\",children:[/*#__PURE__*/_jsx(IconButton,{onClick:function onClick(){return backToConversations();},children:/*#__PURE__*/_jsx(ArrowBackIcon,{style:{height:'30px',width:'30px'}})}),/*#__PURE__*/_jsx(\"h2\",{className:\"title_h2\",children:\" Profile \"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile_details_body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile_pic\",children:[/*#__PURE__*/_jsx(Avatar,{src:previewImage,style:{height:'170px',width:'170px',backgroundColor:'gray',margin:'15px',marginTop:'30px'},children:\" \"}),/*#__PURE__*/_jsxs(\"div\",{className:\"change_image_on_hover\",style:{display:'flex',flexDirection:'column',alignItems:'center',position:'absolute',zIndex:'1',color:'white',curser:'pointer'},children:[/*#__PURE__*/_jsx(AddAPhotoIcon,{style:{height:'30px',width:'30px',color:'white'}}),/*#__PURE__*/_jsx(\"input\",{accept:\"image/*\",id:\"file\",type:\"file\",name:\"file\",onChange:handleFileUpload}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'10px'},children:\"Change Picture \"})]})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"profile_details\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"edit_title\",children:\"your name:\"}),editNameFlag?/*#__PURE__*/_jsxs(\"div\",{children:[emojiFlag?/*#__PURE__*/_jsx(Picker,{onEmojiClick:function onEmojiClick(e,emojiObject){return _onEmojiClick(e,emojiObject);},pickerStyle:{width:'100%',height:'200px'}}):'',/*#__PURE__*/_jsxs(\"div\",{className:\"edit_group_name\",style:{margin:'10px',padding:'5px'},children:[/*#__PURE__*/_jsx(IconButton,{className:classes.root,style:{padding:'3px'},onClick:function onClick(){return changeProfileName();},children:/*#__PURE__*/_jsx(CheckIcon,{fontSize:\"large\"})}),/*#__PURE__*/_jsx(IconButton,{className:classes.root,style:{padding:'3px'},onClick:function onClick(){return setEmojiFlag(!emojiFlag);},children:/*#__PURE__*/_jsx(InsertEmoticonIcon,{fontSize:\"large\"})}),/*#__PURE__*/_jsx(\"input\",{className:\"input_text\",defaultValue:Text,onChange:function onChange(e){return setText(e.target.value);}})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"edit_details\",children:[/*#__PURE__*/_jsx(IconButton,{onClick:function onClick(){return setEditNameFlag(true);},children:/*#__PURE__*/_jsx(EditIcon,{style:{fontSize:'large'}})}),/*#__PURE__*/_jsx(\"h3\",{children:info.name})]})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"profile_details\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"edit_title\",children:\"status:\"}),editStatusFlag?/*#__PURE__*/_jsxs(\"div\",{children:[emojiFlag?/*#__PURE__*/_jsx(Picker,{onEmojiClick:function onEmojiClick(e,emojiObject){return onStatusEmojiClick(e,emojiObject);},pickerStyle:{width:'100%',height:'200px'}}):'',/*#__PURE__*/_jsxs(\"div\",{className:\"edit_group_name\",style:{margin:'10px',padding:'5px'},children:[/*#__PURE__*/_jsx(IconButton,{className:classes.root,style:{padding:'3px'},onClick:function onClick(){return changeProfileStatus();},children:/*#__PURE__*/_jsx(CheckIcon,{fontSize:\"large\"})}),/*#__PURE__*/_jsx(IconButton,{className:classes.root,style:{padding:'3px'},onClick:function onClick(){return setStatusEmojiFlag(!statusEmojiFlag);},children:/*#__PURE__*/_jsx(InsertEmoticonIcon,{fontSize:\"large\"})}),/*#__PURE__*/_jsx(\"input\",{className:\"input_text\",defaultValue:Status,onChange:function onChange(e){return setStatus(e.target.value);}})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"edit_details\",children:[/*#__PURE__*/_jsx(IconButton,{onClick:function onClick(){return setEditStatusFlag(true);},children:/*#__PURE__*/_jsx(EditIcon,{style:{fontSize:'large'}})}),/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'15px'},children:info.Status})]})]})]})]});}export default ProfileDetails;","map":{"version":3,"sources":["C:/Users/User/OneDrive/Desktop/whatsapp/myclient/src/components/profiledetails.js"],"names":["React","useState","axios","useUser","useConversations","useSocket","Avatar","IconButton","makeStyles","ArrowBackIcon","AddAPhotoIcon","EditIcon","CheckIcon","InsertEmoticonIcon","Picker","useStyles","root","backgroundColor","ProfileDetails","backToConversations","info","contacts","setInfo","config","conversations","setConversations","socket","imageName","previewImage","setPreviewImage","editNameFlag","setEditNameFlag","editStatusFlag","setEditStatusFlag","emojiFlag","setEmojiFlag","name","Text","setText","status","Status","setStatus","statusEmojiFlag","setStatusEmojiFlag","classes","onEmojiClick","event","emojiObject","prevText","emoji","onStatusEmojiClick","prevStatus","handleFileUpload","e","picturePath","data","FormData","append","target","files","post","response","url","console","log","obj","phone","LastSeen","lastSeen","put","sessionStorage","window","URL","createObjectURL","changeProfileName","updateConv","map","conversation","updateCon","Name","push","id","newParticipants","Participants","_id","current","emit","changeProfileStatus","height","width","margin","marginTop","display","flexDirection","alignItems","position","zIndex","color","curser","fontSize","padding","value"],"mappings":"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","sourcesContent":["import React,{useState} from 'react'\r\nimport '../css/profiledetails.css'\r\nimport axios from 'axios';\r\nimport {useUser } from '../contexts/userprovider';\r\nimport { useConversations } from '../contexts/conversationsprovider';\r\nimport { useSocket } from \"../contexts/socketprovider\";\r\nimport {Avatar, IconButton,makeStyles } from '@material-ui/core';\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\r\nimport AddAPhotoIcon from '@material-ui/icons/AddAPhoto';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport CheckIcon from '@material-ui/icons/Check';\r\nimport InsertEmoticonIcon from '@material-ui/icons/InsertEmoticon';\r\nimport Picker from 'emoji-picker-react';\r\n\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n      \"&:hover\": {\r\n        backgroundColor: \"transparent\"\r\n  \r\n      }}\r\n    });\r\n\r\nfunction ProfileDetails({backToConversations}) \r\n{\r\n  const {info,contacts,setInfo,config} = useUser()\r\n  const {conversations,setConversations} = useConversations()\r\n  const { socket} = useSocket();\r\n  const [previewImage,setPreviewImage]=useState(info.imageName)\r\n  const [editNameFlag,setEditNameFlag] = useState(false)\r\n  const [editStatusFlag,setEditStatusFlag] = useState(false)\r\n  const [emojiFlag,setEmojiFlag]=useState(false)\r\n  const [Text,setText] = useState(info.name)\r\n  const [Status,setStatus] = useState(info.status)\r\n  const [statusEmojiFlag,setStatusEmojiFlag]=useState(false)\r\n  const classes = useStyles();\r\n\r\n\r\n  //add emoji to name\r\n  const onEmojiClick = (event, emojiObject) => \r\n  {\r\n    setText(prevText => prevText + emojiObject.emoji)\r\n  };\r\n\r\n\r\n  //add emoji to status\r\n  const onStatusEmojiClick = (event, emojiObject) => \r\n  {\r\n    setStatus(prevStatus => prevStatus + emojiObject.emoji)\r\n  };\r\n\r\n  //change profile picture  \r\n  async function handleFileUpload(e)\r\n  {\r\n\r\n    let picturePath=''\r\n    \r\n    const data = new FormData()\r\n    data.append('file',e.target.files[0])\r\n    data.append(\"upload_preset\",\"whatsApp_clone\")\r\n    data.append(\"cloud_name\",\"dsrgpqnyv\")\r\n       \r\n    try\r\n    {\r\n      let response = await axios.post(\"https://api.cloudinary.com/v1_1/dsrgpqnyv/image/upload\",data)\r\n      picturePath =response.data.url\r\n\r\n    }catch(err){console.log(err)}\r\n\r\n    let obj = {name: info.name,phone: info.phone,imageName:picturePath,contacts:contacts,LastSeen:info.lastSeen,Status:info.Status}\r\n\r\n    try\r\n    {\r\n      let response = await axios.put(\"https://messagesapp1.herokuapp.com/api/logIn/\" + sessionStorage['id'],obj,config)\r\n\r\n      if(response.data==='Updated')\r\n        setInfo(obj)\r\n\r\n    }catch(err){console.log(err)}\r\n\r\n      setPreviewImage(window.URL.createObjectURL(e.target.files[0]))\r\n\r\n  }\r\n\r\n  async function changeProfileName()\r\n  {\r\n    let obj = {name: Text,phone: info.phone,imageName:info.imageName,contacts:contacts,LastSeen:info.LastSeen,Status:info.Status}\r\n    try\r\n    {\r\n      let response = await axios.put(\"https://messagesapp1.herokuapp.com/api/logIn/\" + sessionStorage['id'],obj,config)\r\n      if(response.data==='Updated')\r\n      {\r\n        setInfo(obj)\r\n\r\n        let updateConv=[]\r\n\r\n        conversations.map(async (conversation)=>\r\n        {\r\n          let updateCon = ''\r\n          if(conversation.Name === info.name)\r\n          {\r\n            updateCon = {...conversation,Name:Text}\r\n          }\r\n          else updateCon = {...conversation}\r\n\r\n          updateConv.push(updateCon)\r\n\r\n          obj={...obj,id:sessionStorage['id']}\r\n          let newParticipants=[...conversation.Participants,obj]\r\n          updateCon={...updateCon,Participants:newParticipants}\r\n          delete updateCon._id\r\n\r\n          try\r\n          {\r\n            await axios.put(\"https://messagesapp1.herokuapp.com/api/conversations/\"+ conversation._id,updateCon,config)\r\n          }catch(err){console.log(err)}\r\n\r\n          socket.current.emit('conversation-changed',conversation)\r\n\r\n\r\n        })\r\n\r\n        setConversations(updateConv)\r\n\r\n      }\r\n\r\n    }catch(err){console.log(err)}\r\n\r\n    setEmojiFlag(false)\r\n    setEditNameFlag(false)\r\n\r\n  }\r\n\r\n  async function changeProfileStatus()\r\n  {\r\n    let obj = {name:info.name,phone: info.phone,imageName:info.imageName,contacts:contacts,LastSeen:info.LastSeen,Status:Status}\r\n    try\r\n    {\r\n      let response = await axios.put(\"https://messagesapp1.herokuapp.com/api/logIn/\" + sessionStorage['id'],obj,config)\r\n\r\n      if(response.data==='Updated')\r\n        setInfo(obj)\r\n\r\n    }catch(err){console.log(err)}\r\n\r\n    setStatusEmojiFlag(false)\r\n    setEditStatusFlag(false)\r\n\r\n  }\r\n\r\n    return (\r\n        <div className='show_details'>\r\n            <header className='profile_title'>\r\n              <div className='title_and_back_to_conversations'>\r\n                <IconButton onClick={()=>backToConversations()}>\r\n                   <ArrowBackIcon style={{height:'30px',width:'30px'}}  />\r\n                </IconButton>\r\n                <h2 className='title_h2'> Profile </h2>\r\n              </div>\r\n\r\n            </header>\r\n\r\n            <div className='profile_details_body'>\r\n\r\n              <div className='profile_pic'>\r\n                 <Avatar  src={previewImage} style={{height: '170px', width: '170px' ,backgroundColor:'gray' ,margin:'15px',marginTop:'30px'}}> </Avatar>\r\n                 <div className='change_image_on_hover' style={{display:'flex',flexDirection:'column',alignItems:'center',position:'absolute',zIndex:'1',color:'white',curser:'pointer'}}>\r\n                     <AddAPhotoIcon  style={{height: '30px', width: '30px' ,color:'white'}}/>\r\n                     <input accept=\"image/*\" id=\"file\" type=\"file\" name=\"file\" onChange={handleFileUpload}/>\r\n                     <span style={{fontSize:'10px'}}>Change Picture </span>\r\n                 </div>\r\n              </div>\r\n\r\n              <span className='profile_details'>\r\n                <h3 className='edit_title'>your name:</h3>\r\n                {editNameFlag?\r\n                   <div>\r\n                      {emojiFlag?  <Picker onEmojiClick={(e,emojiObject)=>onEmojiClick(e,emojiObject)} pickerStyle={{ width: '100%' ,height:'200px'}}/> : ''}\r\n                      <div className='edit_group_name' style={{margin:'10px',padding:'5px'}}>\r\n                        <IconButton className={classes.root} style={{padding:'3px'}} onClick={()=>changeProfileName()}>\r\n                          <CheckIcon fontSize='large'/>\r\n                        </IconButton>\r\n                        <IconButton className={classes.root} style={{padding:'3px'}} onClick={()=>setEmojiFlag(!emojiFlag)}>\r\n                          <InsertEmoticonIcon fontSize='large'/>\r\n                        </IconButton>\r\n                        <input className='input_text' defaultValue={Text} onChange={(e)=>setText(e.target.value)} ></input>\r\n                      </div>\r\n                    </div>\r\n                    :\r\n                    <div className='edit_details'>\r\n                      <IconButton onClick={()=>setEditNameFlag(true)}>\r\n                        <EditIcon style={{fontSize:'large'}}/>\r\n                      </IconButton>\r\n                      <h3>{info.name}</h3>\r\n                    </div>}\r\n                  </span>\r\n\r\n              <span className='profile_details'>\r\n\r\n              <h3 className='edit_title'>status:</h3>\r\n              {editStatusFlag?\r\n                <div>\r\n                  {emojiFlag?  <Picker onEmojiClick={(e,emojiObject)=>onStatusEmojiClick(e,emojiObject)} pickerStyle={{ width: '100%' ,height:'200px'}}/> : ''}\r\n                  <div className='edit_group_name' style={{margin:'10px',padding:'5px'}}>\r\n                    <IconButton className={classes.root} style={{padding:'3px'}} onClick={()=>changeProfileStatus()}>\r\n                      <CheckIcon fontSize='large'/>\r\n                    </IconButton>\r\n                    <IconButton className={classes.root} style={{padding:'3px'}} onClick={()=>setStatusEmojiFlag(!statusEmojiFlag)}>\r\n                      <InsertEmoticonIcon fontSize='large'/>\r\n                    </IconButton>\r\n                    <input className='input_text' defaultValue={Status} onChange={(e)=>setStatus(e.target.value)} ></input>\r\n                  </div>\r\n                </div>:\r\n                <div className='edit_details'>\r\n                  <IconButton onClick={()=>setEditStatusFlag(true)}>\r\n                    <EditIcon style={{fontSize:'large'}}/>\r\n                  </IconButton>\r\n                  <h3 style={{fontSize:'15px'}}>{info.Status}</h3>\r\n                </div>}\r\n              </span>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ProfileDetails\r\n"]},"metadata":{},"sourceType":"module"}
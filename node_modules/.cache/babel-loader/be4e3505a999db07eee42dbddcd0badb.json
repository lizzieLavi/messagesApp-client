{"ast":null,"code":"import _objectSpread from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/User/OneDrive/Desktop/whatsapp/myclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";var UserContext=/*#__PURE__*/React.createContext();export function useUser(){return useContext(UserContext);}export function UserProvider(_ref){var children=_ref.children;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),contacts=_useState2[0],setContacts=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),info=_useState4[0],setInfo=_useState4[1];var config={'headers':{'x-access-token':sessionStorage['config']}};useEffect(function(){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:getContacts().then(function(res){return setContacts(res);});case 1:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();},[setInfo]);function getContacts(){return _getContacts.apply(this,arguments);}function _getContacts(){_getContacts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.get(\"https://messagesapp1.herokuapp.com/api/logIn/\"+sessionStorage['id'],config);case 2:response=_context3.sent;setInfo({id:response.data._id,name:response.data.name,phone:response.data.phone,imageName:response.data.imageName,LastSeen:response.data.LastSeen,Status:response.data.Status});return _context3.abrupt(\"return\",response.data.contacts);case 5:case\"end\":return _context3.stop();}}},_callee3);}));return _getContacts.apply(this,arguments);}function getSearchContacts(str){getContacts().then(function(res){var SearchResult=res.filter(function(contact){return contact.name.includes(str)===true;});setContacts(SearchResult);});}var createContact=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(name){var checkIfExists,response,contact,newContacts,UpdatedUser;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(name===info.name)){_context2.next=2;break;}return _context2.abrupt(\"return\",{status:'error',message:'cant Add yourself'});case 2:checkIfExists=contacts.filter(function(contact){return contact.name===name;});if(!(checkIfExists.length!==0)){_context2.next=5;break;}return _context2.abrupt(\"return\",{status:'error',message:'already exists'});case 5:_context2.prev=5;_context2.next=8;return axios.get(\"https://messagesapp1.herokuapp.com/api/logIn/getByName/\"+name,config);case 8:response=_context2.sent;if(!(response.data!=='no such user')){_context2.next=24;break;}contact={id:response.data._id,phone:response.data.phone,name:response.data.name,imageName:response.data.imageName,Status:response.data.Status};newContacts=[].concat(_toConsumableArray(contacts),[contact]);setContacts(newContacts);UpdatedUser=_objectSpread(_objectSpread({},info),{},{contacts:newContacts});_context2.prev=14;_context2.next=17;return axios.put(\"https://messagesapp1.herokuapp.com/api/logIn/\"+sessionStorage['id'],UpdatedUser,{'headers':{'x-access-token':sessionStorage['config']}});case 17:_context2.next=22;break;case 19:_context2.prev=19;_context2.t0=_context2[\"catch\"](14);console.log(_context2.t0);case 22:_context2.next=25;break;case 24:return _context2.abrupt(\"return\",{status:'error',message:'user doesnt exist'});case 25:_context2.next=30;break;case 27:_context2.prev=27;_context2.t1=_context2[\"catch\"](5);console.log(_context2.t1);case 30:return _context2.abrupt(\"return\",{status:'ok'});case 31:case\"end\":return _context2.stop();}}},_callee2,null,[[5,27],[14,19]]);}));return function createContact(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(UserContext.Provider,{value:{setContacts:setContacts,setInfo:setInfo,info:info,config:config,contacts:contacts,createContact:createContact,getSearchContacts:getSearchContacts},children:children});}","map":{"version":3,"sources":["C:/Users/User/OneDrive/Desktop/whatsapp/myclient/src/contexts/userprovider.js"],"names":["React","useState","useEffect","useContext","axios","UserContext","createContext","useUser","UserProvider","children","contacts","setContacts","info","setInfo","config","sessionStorage","fetchData","getContacts","then","res","get","response","id","data","_id","name","phone","imageName","LastSeen","Status","getSearchContacts","str","SearchResult","filter","contact","includes","createContact","status","message","checkIfExists","length","newContacts","UpdatedUser","put","console","log"],"mappings":"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","sourcesContent":["\r\nimport React, { useState ,useEffect, useContext} from 'react'\r\nimport axios from 'axios'\r\nconst UserContext = React.createContext()\r\n\r\nexport function useUser() \r\n{\r\n  return useContext(UserContext)\r\n}\r\n\r\nexport  function UserProvider({ children })\r\n{\r\n  const [contacts, setContacts] = useState([])\r\n  const [info,setInfo] =useState({})\r\n  const config= {'headers': {'x-access-token':sessionStorage['config']}}\r\n\r\n\r\n  \r\n  useEffect( () =>\r\n  {\r\n    async function fetchData() \r\n    {\r\n      getContacts().then(res=> setContacts(res))\r\n    }\r\n\r\n    fetchData();\r\n\r\n   },[setInfo])\r\n\r\n   async function getContacts()\r\n   {\r\n      const response = await axios.get(\"https://messagesapp1.herokuapp.com/api/logIn/\"+sessionStorage['id'],config);\r\n      setInfo({id:response.data._id,name:response.data.name,phone:response.data.phone,imageName:response.data.imageName,LastSeen:response.data.LastSeen,Status:response.data.Status})\r\n      return(response.data.contacts)\r\n\r\n   }\r\n   \r\n\r\n  function getSearchContacts(str)\r\n  {\r\n    getContacts().then(res=>\r\n    {\r\n      let SearchResult =res.filter(contact=> contact.name.includes(str) === true)\r\n      setContacts(SearchResult)\r\n    })\r\n\r\n  }\r\n\r\n\r\n  const createContact = async(name) =>\r\n  {\r\n    \r\n    if(name === info.name)\r\n    {\r\n      return {status:'error',message:'cant Add yourself'};\r\n    }\r\n\r\n    let checkIfExists = contacts.filter(contact=> contact.name === name)\r\n\r\n    if(checkIfExists.length !== 0)\r\n    {\r\n      return {status:'error',message:'already exists'};\r\n    }\r\n\r\n    try\r\n    { \r\n\r\n      const response= await axios.get(\"https://messagesapp1.herokuapp.com/api/logIn/getByName/\" + name,config)\r\n\r\n      if(response.data !== 'no such user')\r\n      {\r\n        const contact = {id:response.data._id,phone:response.data.phone,name:response.data.name,imageName:response.data.imageName,Status:response.data.Status}\r\n        let newContacts = [...contacts,contact]\r\n        setContacts(newContacts)\r\n        let UpdatedUser={...info,contacts:newContacts}\r\n        try\r\n        {\r\n          await axios.put(\"https://messagesapp1.herokuapp.com/api/logIn/\" + sessionStorage['id'],UpdatedUser,{'headers': {'x-access-token':sessionStorage['config']}})\r\n        } catch(err){console.log(err)}\r\n      }\r\n      else return {status:'error',message:'user doesnt exist'};\r\n     \r\n    }catch(err){console.log(err)}\r\n\r\n    return {status:'ok'}\r\n    \r\n  }\r\n\r\n\r\n\r\n  return (\r\n    <UserContext.Provider value={{setContacts,setInfo,info,config,contacts,createContact,getSearchContacts }}>\r\n      {children}\r\n    </UserContext.Provider>\r\n  )\r\n}"]},"metadata":{},"sourceType":"module"}
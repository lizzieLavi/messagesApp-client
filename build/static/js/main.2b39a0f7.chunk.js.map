{"version":3,"sources":["components/login.js","contexts/socketprovider.js","contexts/userprovider.js","contexts/conversationsprovider.js","components/conversations.js","components/contacts.js","components/addnewcontact.js","components/createnewgroup.js","components/profiledetails.js","components/sidebar.js","components/addgroupmember.js","components/showgroupdetails.js","components/showuserdetails.js","components/message.js","components/audiomessage.js","components/chatbody.js","components/sendimagebody.js","components/chat.js","components/dashboard.js","components/register.js","components/App.js","index.js"],"names":["LogIn","props","useState","phone","setPhone","UserName","setUserName","Error","setError","history","useHistory","e","a","preventDefault","obj","name","axios","post","response","data","sessionStorage","token","User","_id","CanLogIn","push","class","className","onSubmit","id","type","placeholder","onChange","target","value","required","to","style","margin","SocketContext","React","createContext","useSocket","useContext","SocketProvider","userId","children","socket","useRef","ConnectedUsers","setConnectedUsers","useEffect","current","io","fetchData","emit","on","users","Provider","UserContext","useUser","UserProvider","contacts","setContacts","info","setInfo","config","updateFlag","setUpdateFlag","getContacts","get","imageName","LastSeen","Status","color","console","log","then","res","createContact","status","message","filter","contact","length","newContacts","UpdatedUser","put","updateInformation","user","userToContacts","getSearchContacts","str","SearchResult","includes","ConversationsContext","useConversations","ConversationsProvider","conversations","setConversations","selectedConversation","setSelectedConversation","RefConversations","currentConversationRef","typingFlag","setTypingFlag","currentConversationIsConnected","setCurrentConversationIsConnected","headers","showDetails","setShowDetails","removedFromGroupFlag","setRemovedFromGroupFlag","audio","Audio","renderFlag","setRenderFlag","updateFunction","getConversations","ConversationsList","map","conversation","UpdatedConversation","isGroup","Name","Participants","ConversationImage","ids","image","groupFlag","messages","lastMessage","ConversationExists","find","participants","createdDate","parts","Intl","DateTimeFormat","hc","year","month","day","hour","minute","timeZone","formatToParts","Date","reduce","acc","part","Object","create","timeSent","containsImage","containsRecord","recordURL","FormData","append","url","newConversation","creatorId","Messages","LastMessage","description","Response","prevConversations","updatedConversation","updateDBConv","addCurrentParticipant","UpdatedConversations","forEach","off","some","conversationId","addMessageToConversation","useCallback","UpdatedConv","play","newListOfConversations","newConv","sendMessage","text","imageFlag","imageURL","time","recordFlag","CurrentMessage","sender","AddMessage","newListOfConcversations","updateSenderConversation","createConversation","getSearchConverastions","UpdateConversation","updateConversationParticipant","userUpdatedInfo","infoFlag","information","updateConv","updateCon","newParticipants","tempCon","Conversations","index","onClick","handleSelectedConversation","Avatar","src","slice","Contacts","newConversationCallback","openModalCallback","Button","height","fontSize","startConversation","AddNewContact","closeModal","userNameRef","error","responseStatus","IconButton","ref","CreateNewGroup","selectedContactsId","setSelectedContactsId","groupName","setGroupName","groupImage","setGroupImage","previewImage","setPreviewImage","goToParticipants","setGoToParticipants","handleFileUpload","files","window","URL","createObjectURL","flex","marginLeft","paddingRight","width","backgroundColor","marginTop","display","flexDirection","alignItems","position","zIndex","accept","opacity","padding","borderRadius","border","outline","justifyContent","overflowY","contactId","prevSelectedContactsId","for","process","fontWeight","useStyles","makeStyles","root","ProfileDetails","backToConversations","editNameFlag","setEditNameFlag","editStatusFlag","setEditStatusFlag","emojiFlag","setEmojiFlag","Text","setText","setStatus","statusEmojiFlag","setStatusEmojiFlag","classes","picturePath","curser","onEmojiClick","emojiObject","event","prevText","emoji","pickerStyle","changeProfileName","defaultValue","prevStatus","onStatusEmojiClick","changeProfileStatus","SideBar","choosenAct","setChoosenAct","modalOpen","setModalOpen","searchFlag","setSearchFlag","choosenModal","setChoosenModal","openProfileDetailsFlag","setOpenProfileDetailsFlag","openChoosenModal","modalType","Modal","open","onClose","AddGroupMember","conversationContacts","setConversationContacts","participant","AddMember","ShowGroupDetails","EditGroupNameGlag","setEditGroupNameGlag","EditGroupDescriptionGlag","setEditGroupDescriptionGlag","Description","setDescription","dialogOpen","setDialogOpen","deleteUserDialog","setDeleteUserDialog","userToDelete","setUserToDelete","LastMasage","changeGroupName","paddingLeft","onDescriptionEmojiClick","changeGroupDescription","marginRight","borderBottom","cursor","existsFlag","participantId","openConversation","flexGrow","beforeDeleteUser","Dialog","removeFromGroup","removeUserFromGroup","ShowUserDetails","privateConversationHeader","pictureDialogOpen","setPictureDialogOpen","alt","paddingBottom","Message","SelectedImageURL","setSelectedImageURL","substring","AudioMessage","messageColor","controls","controlsList","ChatBody","inputRef","setRecordFlag","useReactMediaRecorder","startRecording","stopRecording","mediaBlobUrl","clearBlobUrl","audioBlob","setAudioBlob","setRef","node","scrollIntoView","smooth","imageCallback","handleRecord","fetch","blob","cancelRecord","choosenClass","visibility","htmlFor","component","Conversation","SendImageBody","handleSubmit","backToChat","Chat","setImageFlag","setImageURL","returnValue","setTimeout","chatSide","UsersInGroup","groupheader","withRouter","undefined","Register","setName","Picture","setPicture","getColor","Math","random","toString","randomColor","marginBottom","App","setId","dashboard","exact","path","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2b39a0f7.chunk.js","sourcesContent":["import React,{useState} from 'react'\r\nimport '../css/login.css'\r\nimport axios from 'axios'\r\nimport {Link,useHistory} from 'react-router-dom'\r\nimport 'font-awesome/css/font-awesome.min.css';\r\n\r\n\r\n\r\n\r\nexport default function LogIn(props) \r\n{\r\n\r\n  const [phone,setPhone] = useState('');\r\n  const [UserName,setUserName] = useState('');\r\n  const [Error,setError] = useState('')\r\n  const history=useHistory();\r\n\r\n  //get user information and token from DB\r\n  async function handleSubmit(e)\r\n  {\r\n    setError('')\r\n    e.preventDefault()\r\n    let obj = {name: UserName,phone: phone}\r\n    let response = await axios.post(\"https://messagesapp1.herokuapp.com/api/logIn\",obj)\r\n\r\n    if(response.data !== \"not found\")\r\n    {\r\n      sessionStorage['config']= response.data.token \r\n      sessionStorage['id'] = response.data.User._id\r\n      sessionStorage['name'] = response.data.User.name\r\n      props.CanLogIn(response.data.User._id)\r\n\r\n       history.push('/App')\r\n\r\n    }\r\n        \r\n    else\r\n      setError(\"One or more of your identification details is incorrect.\")\r\n\r\n  }\r\n\r\n  return (\r\n  \r\n    <div class=\"overlay\">\r\n      <form className='login_form' onSubmit={handleSubmit}>\r\n        <div class=\"con\">\r\n          <header class=\"head-form\">\r\n            <h2>Log In</h2>\r\n            <p>welcome to  my whatsApp</p>\r\n          </header>\r\n          <div class=\"field-set\">\r\n            <span class=\"input-item\">\r\n              <i class=\"fa fa-user-circle\"></i>\r\n              <input class=\"form-input\" id=\"txt-input\" type=\"text\" placeholder=\"@UserName\" onChange={(e)=> setUserName(e.target.value)} required />\r\n            </span>\r\n            <span class=\"input-item\">\r\n              <i class=\"fa fa-key\"></i>\r\n              <input class=\"form-input\" type=\"password\" placeholder=\"Password\" id=\"pwd\"  name=\"password\" onChange={(e)=> setPhone(e.target.value)} required/>\r\n            </span>\r\n            <button className=\"log-in\" type='submit'> Log In </button>\r\n          </div>\r\n          <div>\r\n            <Link  className=\"submits sign-up defaultLink\" to={`/Register`}>     Sign Up<i style={{margin:'7px'}}class=\"fa fa-user-plus\" aria-hidden=\"true\"/></Link>\r\n          </div>\r\n          {Error}\r\n        </div>\r\n      </form>\r\n    </div>    \r\n  )\r\n}\r\n","import React, { useState,useContext,useRef,useEffect} from 'react'\r\nimport io from 'socket.io-client'\r\n\r\nconst SocketContext = React.createContext()\r\n\r\nexport function useSocket() \r\n{\r\n  return useContext(SocketContext)\r\n}\r\n\r\nexport function SocketProvider({ userId, children }) \r\n{\r\n\r\n  const socket = useRef()\r\n  const [ConnectedUsers,setConnectedUsers] =useState([])\r\n\r\n  useEffect(()=>\r\n  {\r\n    async function fetchData() {\r\n       socket.current = io(\"wss://messagesapp1.herokuapp.com:443/\");\r\n    }\r\n\r\n    fetchData()\r\n\r\n  },[])\r\n\r\nuseEffect(()=>\r\n{\r\n  async function fetchData() \r\n  {\r\n    socket.current.emit(\"AddUser\",sessionStorage['id'])\r\n    socket.current.on(\"getConnectedUsers\", users =>\r\n    {\r\n      setConnectedUsers(users)\r\n    })\r\n  }\r\n\r\n  fetchData();\r\n\r\n},[userId])\r\n\r\n  return (\r\n    <SocketContext.Provider value={{socket,ConnectedUsers}}>\r\n      {children}\r\n    </SocketContext.Provider>\r\n  )\r\n}","\r\nimport React, { useState ,useEffect, useContext} from 'react'\r\nimport axios from 'axios'\r\nimport { useSocket } from \"./socketprovider\";\r\nconst UserContext = React.createContext()\r\n\r\n\r\nexport function useUser() \r\n{\r\n  return useContext(UserContext)\r\n}\r\n\r\nexport  function UserProvider({ children })\r\n{\r\n  const [contacts, setContacts] = useState([])\r\n  const [info,setInfo] =useState({})\r\n  const config= {'headers': {'x-access-token':sessionStorage['config']}}\r\n  const {socket} = useSocket();\r\n  const [updateFlag,setUpdateFlag]=useState(true)\r\n\r\n  \r\n  useEffect( () =>\r\n  {\r\n    async function fetchData() \r\n    {\r\n      getContacts().then(res=> setContacts(res))\r\n    }\r\n\r\n    if(updateFlag)\r\n    {\r\n      fetchData();\r\n      setUpdateFlag(false)\r\n    }\r\n\r\n   },[updateFlag])\r\n\r\n   useEffect(()=>\r\n   {\r\n     async function fetchData() \r\n     {\r\n       if(socket.current ==null ) return;\r\n\r\n       //when other user updates contact information, update this user on changes\r\n       socket.current.on('update-contact',async ()=>\r\n       {\r\n         setUpdateFlag(true)\r\n       })\r\n \r\n   }\r\n \r\n   fetchData();\r\n \r\n   },[])\r\n\r\n   async function getContacts()\r\n   {\r\n      const response = await axios.get(\"https://messagesapp1.herokuapp.com/api/logIn/\"+sessionStorage['id'],config);\r\n      setInfo({id:response.data._id,name:response.data.name,phone:response.data.phone,imageName:response.data.imageName,LastSeen:response.data.LastSeen,Status:response.data.Status,color:response.data.color})\r\n      console.log(response.data.contacts)\r\n      return(response.data.contacts)\r\n\r\n   }\r\n   \r\n\r\n  function getSearchContacts(str)\r\n  {\r\n    getContacts().then(res=>\r\n    {\r\n      let SearchResult =res.filter(contact=> contact.name.includes(str) === true)\r\n      setContacts(SearchResult)\r\n    })\r\n\r\n  }\r\n\r\n\r\n  const createContact = async(name) =>\r\n  {\r\n    \r\n    if(name === info.name)\r\n    {\r\n      return {status:'error',message:'cant Add yourself'};\r\n    }\r\n\r\n    let checkIfExists = contacts.filter(contact=> contact.name === name)\r\n\r\n    if(checkIfExists.length !== 0)\r\n    {\r\n      return {status:'error',message:'already exists'};\r\n    }\r\n\r\n    try\r\n    { \r\n\r\n      const response= await axios.get(\"https://messagesapp1.herokuapp.com/api/logIn/getByName/\" + name,config)\r\n\r\n      if(response.data !== 'no such user')\r\n      {\r\n        const contact = {id:response.data._id,phone:response.data.phone,name:response.data.name,imageName:response.data.imageName,Status:response.data.Status,color:response.data.color}\r\n        let newContacts = [...contacts,contact]\r\n        setContacts(newContacts)\r\n        let UpdatedUser={...info,contacts:newContacts}\r\n        try\r\n        {\r\n          await axios.put(\"https://messagesapp1.herokuapp.com/api/logIn/\" + sessionStorage['id'],UpdatedUser,{'headers': {'x-access-token':sessionStorage['config']}})\r\n        } catch(err){console.log(err)}\r\n      }\r\n      else return {status:'error',message:'user doesnt exist'};\r\n     \r\n    }catch(err){console.log(err)}\r\n\r\n    return {status:'ok'}\r\n\r\n  }\r\n\r\n  const updateInformation = async(user,userToContacts) =>\r\n  {\r\n    try\r\n    {\r\n      let response = await axios.put(\"https://messagesapp1.herokuapp.com/api/logIn/\" + sessionStorage['id'],user,config)\r\n      if(response.data.status==='Updated')\r\n      {\r\n        setInfo({...user,id:sessionStorage['id']})\r\n        \r\n      }\r\n    }catch(err){console.log(err)}\r\n\r\n     socket.current.emit('contact-changed',userToContacts)\r\n  }\r\n\r\n\r\n\r\n  return (\r\n    <UserContext.Provider value={{setContacts,setInfo,info,config,contacts,createContact,getSearchContacts,updateInformation }}>\r\n      {children}\r\n    </UserContext.Provider>\r\n  )\r\n}","import React, { useContext, useCallback, useRef } from \"react\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { useUser } from \"./userprovider\";\r\nimport { useSocket } from \"./socketprovider\";\r\nimport axios from \"axios\";\r\n\r\n\r\n\r\nconst ConversationsContext = React.createContext();\r\n\r\nexport function useConversations() \r\n{\r\n  return useContext(ConversationsContext);\r\n}\r\n\r\nexport function ConversationsProvider({children }) \r\n{\r\n\r\n  const {contacts, info} = useUser();\r\n  const [conversations, setConversations] = useState([]);\r\n  const [selectedConversation, setSelectedConversation] = useState();\r\n  const RefConversations = useRef(conversations);\r\n  const currentConversationRef = useRef(selectedConversation);\r\n  const {socket, ConnectedUsers} = useSocket();\r\n  const [typingFlag,setTypingFlag] =useState('')\r\n  const [currentConversationIsConnected,setCurrentConversationIsConnected] = useState('')\r\n  const config = { headers: { \"x-access-token\": sessionStorage[\"config\"] } };\r\n  const [showDetails,setShowDetails] =useState(false)\r\n  const [removedFromGroupFlag,setRemovedFromGroupFlag] = useState(false)\r\n  const audio = new Audio('https://res.cloudinary.com/dsrgpqnyv/video/upload/v1630680168/juntos-607_qsfc7i.mp3');\r\n  const [renderFlag,setRenderFlag]=useState(true)\r\n \r\n\r\n  const updateFunction=()=>\r\n  {\r\n    setRenderFlag(true)\r\n  }\r\n\r\n  useEffect(()=>\r\n  {\r\n    async function fetchData() \r\n    {\r\n\r\n      if(socket.current ==null ) return;\r\n      //when other user updates conversation information, update this user on changes\r\n      socket.current.on('update-conversation',updateFunction)\r\n   \r\n\r\n\r\n    //when user was removed, remove this user from conversation\r\n    socket.current.on('removed-user',async ()=>\r\n    {\r\n      getConversations().then(res=> \r\n      {\r\n        setConversations(res)\r\n        if(selectedConversation)\r\n        {\r\n          /*if this selected conversation dosn't exists in conversations anymore, this is the deleted user, \r\n          let him know he was deleted and remove this chat from selected conversation*/\r\n          let checkIfDeleted=res.filter(conversation=> conversation._id === selectedConversation._id)\r\n          if(checkIfDeleted.length === 0 ) \r\n            setRemovedFromGroupFlag(true)\r\n\r\n        }\r\n\r\n      })\r\n    \r\n    })\r\n    \r\n    return () =>{\r\n    socket.current.off('update-conversation',updateFunction)\r\n    socket.current.off('remove-conversation')}\r\n\r\n  }\r\n\r\n  fetchData();\r\n\r\n  },[])\r\n\r\n/*everytime a user is connected/dissconnected/ this user entered new conversation,\r\n check if the current conversation user is connected or not*/\r\n  useEffect( ()=>\r\n  {\r\n    async function fetchData() \r\n    {\r\n\r\n      if(selectedConversation)\r\n      {\r\n        if(!selectedConversation.isGroup)\r\n        {\r\n         if(ConnectedUsers.some(user=> user.userId ===selectedConversation.Participants[0].id))\r\n        {\r\n          setCurrentConversationIsConnected('')\r\n        }\r\n        else\r\n        {\r\n          let response = await axios.get(\"https://messagesapp1.herokuapp.com/api/logIn/\"+ selectedConversation.Participants[0].id,config)\r\n          setCurrentConversationIsConnected(response.data.LastSeen)\r\n        }\r\n     }\r\n    }\r\n  }\r\n\r\n  fetchData();\r\n\r\n  },[ConnectedUsers,selectedConversation])\r\n\r\n\r\n  //on first render,and every time conversation updates, get new conversations from DB\r\n  useEffect(() =>\r\n  {\r\n\r\n    async function fetchData() \r\n    {\r\n      getConversations().then(res=> setConversations(res))\r\n    }\r\n\r\n    if(renderFlag)\r\n    {\r\n      \r\n      fetchData();\r\n      setRenderFlag(false)\r\n    }\r\n    \r\n  }, [renderFlag]);\r\n\r\n  //when other user is typing, and this user is on this conversation, let him know other user is typing\r\n  useEffect(() =>\r\n  {\r\n\r\n    if(socket.current ==null ) return;\r\n    socket.current.on('user-typing',({user,conversationId})=>\r\n    {\r\n      if(selectedConversation)\r\n      {\r\n        if(selectedConversation._id === conversationId)\r\n        {\r\n           setTypingFlag(user.name)\r\n        }\r\n      }\r\n    })\r\n\r\n  },[selectedConversation])\r\n\r\n\r\n\r\n  //get updated conversations from DB when needed\r\n  async function getConversations()\r\n  {\r\n\r\n    try\r\n    {\r\n      let response = await axios.get(\"https://messagesapp1.herokuapp.com/api/conversations/UserConversations/\" +sessionStorage[\"id\"],config);\r\n      let ConversationsList = response.data.map((conversation) =>\r\n      {\r\n        let UpdatedConversation= conversation\r\n\r\n        /*if this is a private conversation, and the name and picture saved as this user name, \r\n        update the conversation to other user name and picture*/\r\n        if (!conversation.isGroup && conversation.Name ===  sessionStorage['name'])\r\n          UpdatedConversation = { ...UpdatedConversation,Name: conversation.Participants[0].name,ConversationImage:conversation.Participants[0].imageName}\r\n\r\n\r\n        //update the current shown on screen conversation\r\n        if(selectedConversation)\r\n        {\r\n          if(selectedConversation._id === UpdatedConversation._id)\r\n            setSelectedConversation(UpdatedConversation)\r\n        }\r\n\r\n         return UpdatedConversation;\r\n\r\n      })\r\n\r\n      return ConversationsList \r\n\r\n    } catch (err) {console.log(err);}\r\n\r\n  }\r\n\r\n  //on search event, update shown conversations list\r\n  async function getSearchConverastions(str)\r\n  {\r\n    getConversations().then(res=>\r\n    {\r\n      let SearchResult = res.filter(conversation=> \r\n      conversation.Name.includes(str) ===true)\r\n      setConversations(SearchResult)\r\n    })\r\n\r\n  }\r\n        \r\n\r\n  //create new conversation\r\n  async function createConversation(ids, name, image,groupFlag)\r\n  {\r\n\r\n    let ConversationImage = image;\r\n    let isGroup = groupFlag;\r\n    let messages = []\r\n    let lastMessage=''\r\n\r\n\r\n    //no participants chosen\r\n    if (ids.length === 0) {\r\n      return {status:'error',message:'no participants choosen'};\r\n    }\r\n\r\n    //check if conversation already exists and it's not a group.\r\n    let ConversationExists = null;\r\n    if (ids.length === 1 && !isGroup) {\r\n      ConversationExists = conversations.find(\r\n        (conversation) => conversation.Name === name\r\n      );\r\n    }\r\n\r\n\r\n    //if already exists, show the existing one\r\n    if (ConversationExists) setSelectedConversation(ConversationExists);\r\n\r\n    //create new conversation\r\n    else {\r\n\r\n      //get conversation participants\r\n      const participants = ids.map((id) => \r\n      {\r\n        let addContactToConversation = contacts.filter(\r\n          (contact) => id === contact.id\r\n        );\r\n        return addContactToConversation[0];\r\n      });\r\n\r\n\r\n\r\n      //add creator to participants\r\n      participants.push({\r\n        id: info.id,\r\n        name: info.name,\r\n        phone: info.phone,\r\n        imageName: info.imageName,\r\n        LastSeen: info.LastSeen\r\n      });\r\n\r\n      let createdDate=''\r\n\r\n      //if group add creation date,add creation message and upload group picture\r\n      if (isGroup) \r\n      {\r\n        let parts = new Intl.DateTimeFormat('en', {\r\n          hc: 'h12',\r\n          year: 'numeric',\r\n          month: '2-digit',\r\n          day: '2-digit',\r\n          hour: 'numeric',\r\n          minute: 'numeric',\r\n          timeZone:'Asia/Jerusalem'})\r\n        .formatToParts(new Date())\r\n        .reduce((acc, part) => {\r\n          acc[part.type] = part.value;\r\n          return acc;\r\n        }, Object.create(null));\r\n\r\n        createdDate= `${parts.day}/${parts.month}/${parts.year} ${parts.hour}:${parts.minute}`;\r\n\r\n        lastMessage={name:\"manager\",message: info.name +\" created this group\",timeSent:'',containsImage:false,containsRecord:false,recordURL:null}\r\n        messages.push(lastMessage)\r\n\r\n        const data = new FormData()\r\n        data.append('file',ConversationImage)\r\n        data.append(\"upload_preset\",\"whatsApp_clone\")\r\n        data.append(\"cloud_name\",\"dsrgpqnyv\")\r\n        try\r\n        {\r\n          let response = await axios.post(\"https://api.cloudinary.com/v1_1/dsrgpqnyv/image/upload\",data)\r\n          ConversationImage = response.data.url;\r\n\r\n        }catch(err){console.log(err)}\r\n   \r\n      }\r\n    \r\n      let newConversation = \r\n      {\r\n        Name: name,\r\n        creatorId: sessionStorage[\"id\"],\r\n        Participants: participants,\r\n        Messages: messages,\r\n        LastMessage:lastMessage,\r\n        ConversationImage: ConversationImage,\r\n        isGroup:isGroup,\r\n        createdDate:createdDate,\r\n        description: \"Add Description\",\r\n      };\r\n\r\n      //updateDB\r\n      try \r\n      {\r\n        let Response = await axios.post(\r\n          \"https://messagesapp1.herokuapp.com/api/conversations\",\r\n          newConversation,\r\n          config\r\n        );\r\n\r\n        if (Response.data.status === \"created\") \r\n        {\r\n          setSelectedConversation(Response.data.conversation);\r\n\r\n          //show conversation only if messages sent or if its A group\r\n          if (Response.data.conversation.Messages.length > 0  || Response.data.conversation.isGroup === true)\r\n          {\r\n            setConversations((prevConversations) => {\r\n              return [...prevConversations, Response.data.conversation];\r\n            });\r\n            socket.current.emit('conversation-changed',Response.data.conversation)\r\n          }\r\n        }\r\n      }catch (err) {console.log(err);}\r\n    }\r\n  }\r\n\r\n\r\n  //update existing conversation details when changed \r\n  async function UpdateConversation(updatedConversation)\r\n  {\r\n\r\n    let updateDBConv={...updatedConversation}\r\n\r\n    //if user left the group, dont add him to DB\r\n    if(!(updatedConversation.LastMessage.message.includes('left')))\r\n    {\r\n      let addCurrentParticipant= {id: info.id,phone: info.phone,name: info.name,imageName: info.imageName,Status:info.Status,color:info.color}\r\n      let participants=[...updatedConversation.Participants,addCurrentParticipant]\r\n      updateDBConv={...updateDBConv,Participants:participants}\r\n    }\r\n\r\n    delete updateDBConv._id\r\n\r\n    try\r\n    {\r\n      let response=await axios.put(\"https://messagesapp1.herokuapp.com/api/conversations/\"+ selectedConversation._id,updateDBConv,config)\r\n      if(response.data.status==='Updated')\r\n      {\r\n        let UpdatedConversations=[]\r\n        if(!(updatedConversation.LastMessage.message.includes('left')))\r\n        {\r\n          setSelectedConversation(updatedConversation)\r\n          conversations.forEach(conversation=>\r\n          { \r\n            if(conversation._id===updatedConversation._id)    \r\n              UpdatedConversations.push(updatedConversation)\r\n            else UpdatedConversations.push(conversation)\r\n\r\n          })\r\n        }\r\n        else\r\n        {\r\n          UpdatedConversations=conversations.filter(conversation=> conversation._id !== selectedConversation._id)\r\n          setSelectedConversation()\r\n        }\r\n\r\n\r\n        //if user where removed by admin, send to user deleted case, so server let him know he was deleted\r\n        if(updatedConversation.LastMessage.message.includes('removed'))\r\n          socket.current.emit('user-deleted',selectedConversation)\r\n        else\r\n          socket.current.emit('conversation-changed',selectedConversation)\r\n\r\n        setConversations(UpdatedConversations)\r\n              \r\n      }\r\n    }catch(err){console.log(err)}\r\n  }\r\n\r\n  function updateConversationParticipant(userUpdatedInfo,infoFlag,information)\r\n  {\r\n\r\n    let updateConv=[]\r\n    conversations.map(async (conversation)=>\r\n    {\r\n      let updateCon = ''\r\n\r\n      if(conversation.Name === userUpdatedInfo.info && conversation.isGroup==false)\r\n      {\r\n        if(infoFlag === 'name')\r\n        {\r\n          updateCon = {...conversation,Name:information}\r\n        }\r\n\r\n        else if(infoFlag=='image')\r\n            updateCon = {...conversation,ConversationImage:information}\r\n\r\n\r\n    }\r\n\r\n      else updateCon = {...conversation}\r\n\r\n      updateConv.push(updateCon)\r\n\r\n\r\n      let newParticipants=[...conversation.Participants,userUpdatedInfo]\r\n      let tempCon={...updateCon,Participants:newParticipants}\r\n      delete tempCon._id\r\n\r\n      try\r\n      {\r\n        await axios.put(\"https://messagesapp1.herokuapp.com/api/conversations/\"+ conversation._id,tempCon,config)\r\n\r\n      }catch(err){console.log(err)}\r\n\r\n      \r\n      socket.current.emit('conversation-changed',updateCon)\r\n      setConversations(updateConv)\r\n\r\n    })\r\n\r\n  }\r\n\r\n\r\n  //add message got from other user to conversation\r\n  const addMessageToConversation = useCallback(async ({ UpdatedConv }) =>\r\n  {\r\n\r\n    //voice alert\r\n    audio.play()\r\n\r\n    let ConversationExists = false;\r\n\r\n    //use refConversations to void infinite loop\r\n    let newListOfConversations = RefConversations.current.map((conversation) =>\r\n    {\r\n      if (conversation._id === UpdatedConv._id) \r\n      {\r\n        ConversationExists = true;\r\n        let newConv = \r\n        { ...conversation,\r\n          Messages: UpdatedConv.Messages,\r\n          LastMessage: UpdatedConv.LastMessage,};\r\n          if (currentConversationRef.current) \r\n          {\r\n           if (currentConversationRef.current._id === UpdatedConv._id)\r\n             setSelectedConversation(newConv);\r\n          }\r\n\r\n        return newConv;\r\n\r\n      }\r\n      else return conversation;\r\n    });\r\n\r\n   // if this is a new conversation first message, update user conversations\r\n    if (!ConversationExists) \r\n    {\r\n      if (!UpdatedConv.isGroup)\r\n      {\r\n        let newConversation = \r\n        { ...UpdatedConv,\r\n        Name: UpdatedConv.Participants[0].name,\r\n        ConversationImage: UpdatedConv.Participants[0].imageName,\r\n        };\r\n\r\n        setConversations((prevConversations) => [...prevConversations, newConversation ]);\r\n      } \r\n      else\r\n        setConversations((prevConversations) => [...prevConversations,UpdatedConv]);\r\n    } \r\n    else setConversations(newListOfConversations);\r\n  },[setConversations]);\r\n\r\n\r\n  //handle messages socket\r\n  useEffect(() => \r\n  {\r\n\r\n    if (socket.current == null) return;\r\n    \r\n    RefConversations.current = conversations;\r\n    currentConversationRef.current = selectedConversation;\r\n    socket.current.on(\"receive-message\", addMessageToConversation);\r\n\r\n    return () =>\r\n      socket.current.off(\"receive-message\", addMessageToConversation);\r\n  },[conversations, selectedConversation]);\r\n\r\n\r\n\r\n  //update the message sender conversations\r\n  const updateSenderConversation = (AddMessage) => \r\n  {\r\n\r\n    let ConversationExists = false;\r\n    setSelectedConversation(AddMessage);\r\n\r\n    let newListOfConcversations = conversations.map((conversation) => \r\n    {\r\n      if (conversation._id === AddMessage._id) \r\n      {\r\n        ConversationExists = true;\r\n        return AddMessage;\r\n      } \r\n      else return conversation;\r\n\r\n    });\r\n\r\n    if (ConversationExists) \r\n    {\r\n      setConversations(newListOfConcversations);\r\n    } \r\n    else\r\n      setConversations((prevConversations) => [...prevConversations,AddMessage]);\r\n  };\r\n\r\n\r\n\r\n  //send new message to chat users\r\n  function sendMessage(text,imageFlag,imageURL,recordURL) {\r\n\r\n\r\n    let parts = new Intl.DateTimeFormat('en', {\r\n    hc: 'h12',\r\n    year: 'numeric',\r\n    month: '2-digit',\r\n    day: '2-digit',\r\n    hour: 'numeric',\r\n    minute: 'numeric',\r\n    timeZone:'Asia/Jerusalem'})\r\n    .formatToParts(new Date())\r\n    .reduce((acc, part) => \r\n    {\r\n      acc[part.type] = part.value;\r\n      return acc;\r\n    }, Object.create(null));\r\n\r\n    let time = `${parts.day}/${parts.month}/${parts.year}  ${parts.hour}:${parts.minute}`;\r\n\r\n    let recordFlag= false\r\n\r\n    if(recordURL!=null)\r\n       recordFlag=true\r\n    \r\n    let CurrentMessage = { id: info.id, name: info.name,color:info.color, message: text  ,timeSent: time ,containsImage: imageFlag,containsRecord:recordFlag,recordURL:recordURL};\r\n    if(imageFlag ===true)\r\n       CurrentMessage= {...CurrentMessage,imageURL:imageURL}\r\n    \r\n    let sender = \r\n    {\r\n      id: info.id,\r\n      phone: info.phone,\r\n      name: info.name,\r\n      imageName: info.imageName,\r\n    };\r\n\r\n    let AddMessage = \r\n    {...selectedConversation,\r\n      Messages: [...selectedConversation.Messages, CurrentMessage],\r\n      LastMessage: CurrentMessage,\r\n    };\r\n\r\n    socket.current.emit(\"send-message\", \r\n    {\r\n      sender: sender,\r\n      UpdatedConversation: AddMessage,\r\n      conversationId: selectedConversation._id,\r\n    });\r\n\r\n    updateSenderConversation(AddMessage);\r\n  }\r\n\r\n  return (\r\n    <ConversationsContext.Provider\r\n      value={{\r\n        sendMessage,\r\n        conversations,\r\n        createConversation,\r\n        setConversations,\r\n        setSelectedConversation,\r\n        selectedConversation,\r\n        currentConversationIsConnected,\r\n        typingFlag,\r\n        setTypingFlag,\r\n        getSearchConverastions,\r\n        showDetails,\r\n        setShowDetails,\r\n        UpdateConversation,\r\n        removedFromGroupFlag,\r\n        setRemovedFromGroupFlag,\r\n        updateConversationParticipant\r\n      \r\n      }}\r\n    >\r\n      {children}\r\n    </ConversationsContext.Provider>\r\n  );\r\n}\r\n","import React from 'react'\r\nimport {Avatar} from '@material-ui/core';\r\nimport {useConversations} from '../contexts/conversationsprovider';\r\nimport '../css/conversations.css'\r\n\r\nexport default function Conversations() \r\n{\r\n\r\n  const {setSelectedConversation,conversations,setShowDetails} =useConversations()\r\n\r\n  \r\n  async function handleSelectedConversation(conversation) \r\n  {\r\n    setShowDetails(false)\r\n    setSelectedConversation(conversation)\r\n  }\r\n\r\n\r\n  return (\r\n    <div className='Chats' >\r\n      <div className='contacts_list'>\r\n        {conversations.map((conversation,index)=>\r\n        {\r\n          return  (   \r\n            <div key={index}  onClick={()=>handleSelectedConversation(conversation)}  className='ChatsListItem'>\r\n              {console.log(conversation)}\r\n              {conversation.isGroup?\r\n              <Avatar src={conversation.ConversationImage}/>:<Avatar src={conversation.Participants[0].imageName}/>}\r\n              <div className='chatInfo'>\r\n                <h2 className='user_name'>{conversation.Name}</h2>\r\n                <span className='user_status'> {(conversation.LastMessage.message).slice(0,43)}\r\n                {conversation.LastMessage.message.length > 43? '...' :''} </span>\r\n              </div>\r\n            \r\n            </div>\r\n          )\r\n                    \r\n                })}\r\n      </div>\r\n    </div>\r\n  )\r\n}","import React from 'react'\r\nimport {Avatar,Button} from '@material-ui/core';\r\nimport {useUser} from '../contexts/userprovider';\r\nimport {useConversations} from '../contexts/conversationsprovider'\r\nimport '../css/conversations.css'\r\n\r\nexport default function Contacts({newConversationCallback,openModalCallback}) \r\n{\r\n\r\n  const {contacts} = useUser()\r\n  const {createConversation} = useConversations()\r\n\r\n  function startConversation({id,name,image}) \r\n  {\r\n    let ids=[id]\r\n    createConversation(ids,name,image,false)\r\n    newConversationCallback()\r\n    \r\n  }\r\n\r\n  return (\r\n\r\n    <div className='Chats contacts'  >\r\n      <h4 className='new_chat_title'>Start New Chat:</h4>            \r\n      <Button  style={{height:'30px' ,margin:'5px 0px',fontSize:'10px'}} onClick={()=>openModalCallback()}\r\n      className='add_new_Button' > Create Group </Button>\r\n      <div className='contacts_list'>\r\n        {contacts.map(contact =>\r\n        {\r\n          return(\r\n         \r\n           <div className='ChatsListItem' onClick={()=>startConversation({id:contact.id,name:contact.name,image:contact.imageName})}>\r\n             <Avatar src={contact.imageName}/>\r\n              <div className='chatInfo'>\r\n                <h2 className='user_name'>{contact.name} </h2>\r\n                <span className='user_status'> {contact.Status.slice(0,25)}\r\n                {contact.Status.length > 25? '...' :''}\r\n                </span>\r\n\r\n              </div>\r\n            </div> \r\n          )\r\n        })}\r\n      </div>\r\n    </div>\r\n  )\r\n  \r\n};","import { useRef,useState } from 'react'\r\nimport {useUser } from '../contexts/userprovider';\r\nimport {IconButton } from '@material-ui/core'\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport '../css/addnew.css'\r\n\r\n\r\nexport default function AddNewContact({closeModal})\r\n{\r\n\r\n  const userNameRef = useRef()\r\n  const {createContact} = useUser()\r\n  const [error,setError]=useState('')\r\n   \r\n\r\n  async function AddContact()\r\n  {\r\n\r\n    let responseStatus = await createContact(userNameRef.current.value)\r\n\r\n    if(responseStatus.status === 'ok')\r\n    {\r\n       closeModal();\r\n       setError('')\r\n    }\r\n    \r\n    else\r\n    {\r\n      setError(responseStatus.message)\r\n    }\r\n   \r\n  }\r\n\r\n  return (\r\n   \r\n    <div className='add_new'>\r\n        <div className='add_new_contact_border'>\r\n            <div className='add_contact_model'>\r\n                <div className='title_and_close'>\r\n                  <h2 className='add_contact_title'>Add New Contact</h2> \r\n                  <IconButton className='close_add_new'  onClick={()=>closeModal()}>\r\n                    <CloseIcon fontSize='large' /> \r\n                  </IconButton>\r\n                </div>\r\n        \r\n                <div className='add_new_contact'>\r\n                  <h3 className='enter_phone'>userName:</h3>\r\n                  <input className='add_new_input' type='text' ref={userNameRef} required/>\r\n                  <button className='add_new_button' onClick={AddContact}> Add Contact</button>\r\n                </div>\r\n                <span className='show_error'>{error}</span>\r\n            </div>\r\n\r\n        </div>       \r\n    </div>\r\n\r\n  )\r\n}","import React, {useState } from 'react'\r\nimport {useUser } from '../contexts/userprovider'\r\nimport {useConversations } from '../contexts/conversationsprovider'\r\nimport {Avatar,IconButton} from '@material-ui/core';\r\nimport AddAPhotoIcon from '@material-ui/icons/AddAPhoto';\r\nimport PeopleAltIcon from '@material-ui/icons/PeopleAlt';\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nfunction CreateNewGroup( { closeModal }) {\r\n\r\n    const [selectedContactsId, setSelectedContactsId] = useState([])\r\n    const {contacts} = useUser()\r\n    const {createConversation} = useConversations()\r\n    const [groupName,setGroupName] =useState('')\r\n    const [groupImage,setGroupImage] =useState()\r\n    const [previewImage,setPreviewImage]=useState()\r\n    const [goToParticipants,setGoToParticipants] = useState(false)\r\n\r\n\r\n    function createGroup()\r\n    {\r\n        createConversation(selectedContactsId,groupName,groupImage,true)\r\n        closeModal()\r\n    }\r\n\r\n    \r\n    function handleCheckboxChange(contactId) \r\n    {\r\n        if(selectedContactsId.includes(contactId))\r\n        {\r\n            setSelectedContactsId(prevSelectedContactsId =>\r\n            {\r\n                return (prevSelectedContactsId.filter(id=> id!==contactId))\r\n            } )\r\n        }\r\n  \r\n        else\r\n        {\r\n           setSelectedContactsId(prevSelectedContactsId=>\r\n            {\r\n              return [...prevSelectedContactsId,contactId]\r\n            })\r\n        }   \r\n    }\r\n\r\n    function handleFileUpload(e)\r\n    {\r\n        setGroupImage(e.target.files[0])\r\n        setPreviewImage(window.URL.createObjectURL(e.target.files[0]))\r\n    }\r\n\r\n\r\n    return (\r\n      <div className='add_new'>\r\n        <div className='add_new_group_border'>\r\n          <div className='new_conversation new_group'>\r\n            {goToParticipants !==true ?\r\n            <div className='top_new_group'>\r\n              <div style={{flex:'1'}}className='title_and_close'>\r\n                <h2 className='add_contact_title' style={{marginLeft:'85px',paddingRight:'0px'}}>Create New Group:</h2> \r\n                <IconButton style={{marginLeft:'45px'}}className='close_add_new'  onClick={()=>closeModal()}>\r\n                  <CloseIcon fontSize='large' /> \r\n                </IconButton>\r\n              </div>\r\n\r\n              {previewImage? \r\n              <div className='change_group_image'> \r\n                <Avatar  src={previewImage} style={{height: '110px', width: '110px' ,backgroundColor:'gray' ,margin:'15px',marginTop:'30px'}}>  </Avatar>\r\n                <div className='change_image_on_hover' style={{display:'flex',flexDirection:'column',alignItems:'center',position:'absolute',zIndex:'1',color:'white'}}>\r\n                  <AddAPhotoIcon  style={{height: '30px', width: '30px' ,color:'white'}}/>\r\n                  <input accept=\"image/*\" id=\"file\" type=\"file\" name=\"file\" onChange={handleFileUpload}/>\r\n                  <span style={{fontSize:'10px'}}>Change Image </span>\r\n                </div>\r\n              </div>\r\n              :\r\n              <div className='add_group_image'>\r\n                <Avatar   style={{height: '110px', width: '110px' ,backgroundColor:'gray' ,margin:'15px',marginTop:'30px'}}>\r\n                  <PeopleAltIcon style={{position:'absolute',zIndex:'0', opacity:'0.1',height: '80px', width: '80px' }}/>\r\n                  <div  style={{display:'flex',flexDirection:'column',alignItems:'center',position:'absolute',zIndex:'1',color:'white'}}>\r\n                    <AddAPhotoIcon  style={{height: '30px', width: '30px' ,color:'white'}}/>\r\n                    <input accept=\"image/*\" id=\"file\" type=\"file\" name=\"file\" onChange={handleFileUpload}/>\r\n                    <span style={{fontSize:'10px'}}>add group image</span>\r\n                  </div>\r\n                </Avatar>\r\n              </div> }\r\n              <div className='group_name'>\r\n                <span style={{padding:'5px', margin:'5px' , fontSize:'13px', color:'#fcfcfc'}}> Group Name:</span>\r\n                <input style={{borderRadius:'10px', border:'none',outline:'none'}} onChange={(e)=>setGroupName(e.target.value)}/>\r\n              </div>\r\n              <button style={{display:'flex',alignItems:'center',width:'180px',justifyContent:'center'}} className='add_new_button'  onClick={()=>setGoToParticipants(true)}><ArrowBackIcon style={{margin:'5px'}} /> Add Members</button>\r\n            </div>\r\n            :\r\n            <div>\r\n              <div style={{flex:'1'}}className='title_and_close'>\r\n                <h2 className='add_contact_title' style={{marginLeft:'80px',paddingRight:'0px'}}>Select Members:</h2> \r\n                <IconButton style={{marginLeft:'40px'}}className='close_add_new'  onClick={()=>closeModal()}>\r\n                  <CloseIcon fontSize='large' /> \r\n                </IconButton>\r\n              </div>\r\n              <div style={{overflowY:'overlay',height:'200px'}}>\r\n              {contacts.map(contact =>\r\n              {\r\n                return(\r\n                  <div className='contact_item' >\r\n                    <input type=\"checkbox\" value={selectedContactsId.includes(contact.id)}\r\n                    id={contact.id} onChange={() => handleCheckboxChange(contact.id)}/>\r\n                    <label style={{display:'flex',flexDirection:'row',alignItems:'center',width:'100%'}}for={contact.id} >\r\n                      <Avatar  style={{margin:'5px'}} src={process.env.PUBLIC_URL + contact.imageName}   fontSize='large'/>\r\n                      <h3 className='enter_phone' style={{marginLeft:'10px' ,fontWeight:'400'}}>{contact.name} </h3>\r\n                    </label>\r\n                  </div>\r\n                )}) \r\n                }  \r\n              </div>\r\n              <div style={{display:'flex' , justifyContent:'center'}}>\r\n                <button className='add_new_button'  type=\"submit\" onClick={()=>createGroup()}>Create</button>\r\n              </div>\r\n\r\n            </div>}  \r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n}\r\n\r\nexport default CreateNewGroup\r\n","import React,{useState} from 'react'\r\nimport '../css/profiledetails.css'\r\nimport axios from 'axios';\r\nimport {useUser } from '../contexts/userprovider';\r\nimport { useConversations } from '../contexts/conversationsprovider';\r\nimport {Avatar, IconButton,makeStyles } from '@material-ui/core';\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\r\nimport AddAPhotoIcon from '@material-ui/icons/AddAPhoto';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport CheckIcon from '@material-ui/icons/Check';\r\nimport InsertEmoticonIcon from '@material-ui/icons/InsertEmoticon';\r\nimport Picker from 'emoji-picker-react';\r\n\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n      \"&:hover\": {\r\n        backgroundColor: \"transparent\"\r\n  \r\n      }}\r\n    });\r\n\r\nfunction ProfileDetails({backToConversations}) \r\n{\r\n  const {info,contacts,updateInformation} = useUser()\r\n  const {updateConversationParticipant} = useConversations()\r\n  const [previewImage,setPreviewImage]=useState(info.imageName)\r\n  const [editNameFlag,setEditNameFlag] = useState(false)\r\n  const [editStatusFlag,setEditStatusFlag] = useState(false)\r\n  const [emojiFlag,setEmojiFlag]=useState(false)\r\n  const [Text,setText] = useState(info.name)\r\n  const [Status,setStatus] = useState(info.status)\r\n  const [statusEmojiFlag,setStatusEmojiFlag]=useState(false)\r\n  const classes = useStyles();\r\n\r\n\r\n  //add emoji to name\r\n  const onEmojiClick = (event, emojiObject) => \r\n  {\r\n    setText(prevText => prevText + emojiObject.emoji)\r\n  };\r\n\r\n\r\n  //add emoji to status \r\n  const onStatusEmojiClick = (event, emojiObject) => \r\n  {\r\n    setStatus(prevStatus => prevStatus + emojiObject.emoji)\r\n  };\r\n\r\n\r\n  //change profile picture  and update users on real time\r\n  async function handleFileUpload(e)\r\n  {\r\n\r\n    let picturePath=''\r\n    \r\n    const data = new FormData()\r\n    data.append('file',e.target.files[0])\r\n    data.append(\"upload_preset\",\"whatsApp_clone\")\r\n    data.append(\"cloud_name\",\"dsrgpqnyv\")\r\n       \r\n    try\r\n    {\r\n\r\n      let response = await axios.post(\"https://api.cloudinary.com/v1_1/dsrgpqnyv/image/upload\",data)\r\n      picturePath =response.data.url\r\n      \r\n      let user = {name:info.name,phone: info.phone,imageName:picturePath,contacts:contacts,LastSeen:info.LastSeen,Status:info.Status,color:info.color}\r\n      let userToContacts={id:sessionStorage['id'],name:info.name,phone: info.phone,imageName:picturePath,Status:info.Status,color:info.color}\r\n      updateConversationParticipant(userToContacts,'image',picturePath)\r\n      updateInformation(user,userToContacts)\r\n\r\n    }catch(err){console.log(err)}\r\n\r\n    setPreviewImage(window.URL.createObjectURL(e.target.files[0]))\r\n\r\n  }\r\n\r\n\r\n   //change user nickname  and update users on real time\r\n  async function changeProfileName()\r\n  {\r\n    let user = {name: Text,phone: info.phone,imageName:info.imageName,contacts:contacts,LastSeen:info.LastSeen,Status:info.Status,color:info.color}\r\n    let userToContacts={id:sessionStorage['id'],name: Text,phone: info.phone,imageName:info.imageName,Status:info.Status}\r\n\r\n    sessionStorage['name' ] = Text\r\n\r\n    updateConversationParticipant(userToContacts,'name',Text)\r\n    updateInformation(user,userToContacts)\r\n    setEmojiFlag(false)\r\n    setEditNameFlag(false)\r\n\r\n  }\r\n\r\n\r\n   //change status  and update users on real time\r\n  async function changeProfileStatus()\r\n  {\r\n\r\n    let user = {name:info.name,phone: info.phone,imageName:info.imageName,contacts:contacts,LastSeen:info.LastSeen,Status:Status,color:info.color}\r\n    let userToContacts={id:sessionStorage['id'],name:info.name,phone: info.phone,imageName:info.imageName,Status:Status}\r\n\r\n    updateConversationParticipant(userToContacts,'status',Status)\r\n    updateInformation(user,userToContacts)\r\n    setStatusEmojiFlag(false)\r\n    setEditStatusFlag(false)\r\n\r\n  }\r\n\r\n\r\n\r\n    return (\r\n        <div className='show_details'>\r\n            <header className='profile_title'>\r\n              <div className='title_and_back_to_conversations'>\r\n                <IconButton onClick={()=>backToConversations()}>\r\n                   <ArrowBackIcon style={{height:'30px',width:'30px'}}  />\r\n                </IconButton>\r\n                <h2 className='title_h2'> Profile </h2>\r\n              </div>\r\n\r\n            </header>\r\n\r\n            <div className='profile_details_body'>\r\n\r\n              <div className='profile_pic'>\r\n                 <Avatar  src={previewImage} style={{height: '170px', width: '170px' ,backgroundColor:'gray' ,margin:'15px',marginTop:'30px'}}> </Avatar>\r\n                 <div className='change_image_on_hover' style={{display:'flex',flexDirection:'column',alignItems:'center',position:'absolute',zIndex:'1',color:'white',curser:'pointer'}}>\r\n                     <AddAPhotoIcon  style={{height: '30px', width: '30px' ,color:'white'}}/>\r\n                     <input accept=\"image/*\" id=\"file\" type=\"file\" name=\"file\" onChange={handleFileUpload}/>\r\n                     <span style={{fontSize:'10px'}}>Change Picture </span>\r\n                 </div>\r\n              </div>\r\n\r\n              <span className='profile_details'>\r\n                <h3 className='edit_title'>your name:</h3>\r\n                {editNameFlag?\r\n                   <div>\r\n                      {emojiFlag?  <Picker onEmojiClick={(e,emojiObject)=>onEmojiClick(e,emojiObject)} pickerStyle={{ width: '100%' ,height:'200px'}}/> : ''}\r\n                      <div className='edit_group_name' style={{margin:'10px',padding:'5px'}}>\r\n                        <IconButton className={classes.root} style={{padding:'3px'}} onClick={()=>changeProfileName()}>\r\n                          <CheckIcon fontSize='large'/>\r\n                        </IconButton>\r\n                        <IconButton className={classes.root} style={{padding:'3px'}} onClick={()=>setEmojiFlag(!emojiFlag)}>\r\n                          <InsertEmoticonIcon fontSize='large'/>\r\n                        </IconButton>\r\n                        <input className='input_text' defaultValue={Text} onChange={(e)=>setText(e.target.value)} ></input>\r\n                      </div>\r\n                    </div>\r\n                    :\r\n                    <div className='edit_details'>\r\n                      <IconButton onClick={()=>setEditNameFlag(true)}>\r\n                        <EditIcon style={{fontSize:'large'}}/>\r\n                      </IconButton>\r\n                      <h3>{info.name}</h3>\r\n                    </div>}\r\n                  </span>\r\n\r\n              <span className='profile_details'>\r\n\r\n              <h3 className='edit_title'>status:</h3>\r\n              {editStatusFlag?\r\n                <div>\r\n                  {emojiFlag?  <Picker onEmojiClick={(e,emojiObject)=>onStatusEmojiClick(e,emojiObject)} pickerStyle={{ width: '100%' ,height:'200px'}}/> : ''}\r\n                  <div className='edit_group_name' style={{margin:'10px',padding:'5px'}}>\r\n                    <IconButton className={classes.root} style={{padding:'3px'}} onClick={()=>changeProfileStatus()}>\r\n                      <CheckIcon fontSize='large'/>\r\n                    </IconButton>\r\n                    <IconButton className={classes.root} style={{padding:'3px'}} onClick={()=>setStatusEmojiFlag(!statusEmojiFlag)}>\r\n                      <InsertEmoticonIcon fontSize='large'/>\r\n                    </IconButton>\r\n                    <input className='input_text' defaultValue={Status} onChange={(e)=>setStatus(e.target.value)} ></input>\r\n                  </div>\r\n                </div>:\r\n                <div className='edit_details'>\r\n                  <IconButton onClick={()=>setEditStatusFlag(true)}>\r\n                    <EditIcon style={{fontSize:'large'}}/>\r\n                  </IconButton>\r\n                  <h3 style={{fontSize:'15px'}}>{info.Status}</h3>\r\n                </div>}\r\n              </span>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ProfileDetails\r\n","import '../css/sidebar.css'\r\nimport React from 'react'\r\nimport { useState} from 'react';\r\nimport ChatIcon from '@material-ui/icons/Chat';\r\nimport SearchOutlined from '@material-ui/icons/SearchOutlined';\r\nimport { Avatar, IconButton,Button, Modal } from '@material-ui/core';\r\nimport PeopleIcon from '@material-ui/icons/People';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\r\nimport Conversations from './conversations';\r\nimport Contacts from './contacts';\r\nimport AddNewContact from './addnewcontact'\r\nimport { useUser } from '../contexts/userprovider';\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\r\nimport {useConversations } from '../contexts/conversationsprovider';\r\nimport CreateNewGroup from './createnewgroup';\r\nimport ProfileDetails from './profiledetails';\r\n\r\n\r\n\r\n\r\nexport default function SideBar() \r\n{\r\n  const [choosenAct,setChoosenAct]=useState('conversations')\r\n  const [modalOpen, setModalOpen] = useState(false)\r\n  const {info,getSearchContacts} =useUser()\r\n  const [searchFlag,setSearchFlag] =useState(false)\r\n  const {getSearchConverastions} = useConversations()\r\n  const [choosenModal,setChoosenModal] =useState('')\r\n  const [openProfileDetailsFlag,setOpenProfileDetailsFlag]=useState(false)\r\n    \r\n    \r\n  function handleChange(e)\r\n  {\r\n    if(choosenAct === 'conversations')\r\n      getSearchConverastions(e.target.value)\r\n\r\n    else getSearchContacts(e.target.value)\r\n\r\n  }\r\n\r\n  function closeModal() \r\n  {\r\n    setModalOpen(false)\r\n  }\r\n\r\n  function openChoosenModal(modalType)\r\n  {\r\n    setModalOpen(true)\r\n    setChoosenModal(modalType)\r\n  }\r\n\r\n  function backToConversationsCallback()\r\n  {\r\n    setOpenProfileDetailsFlag(false)\r\n  }\r\n\r\n  return (\r\n    \r\n    <div className='sideBar'>\r\n\r\n      {openProfileDetailsFlag? <ProfileDetails backToConversations={backToConversationsCallback}/>:\r\n        <div>\r\n          <div className='sidebar_top'>\r\n            <div className='user_profile_pic' onClick={()=> setOpenProfileDetailsFlag(true)}>\r\n              <Avatar src={info.imageName} fontSize='large' />\r\n            </div>\r\n            <div className='sidebar_top_right'>\r\n              <IconButton onClick={()=>setChoosenAct('conversations')}>\r\n                <ChatIcon fontSize='large' />\r\n              </IconButton>\r\n              <IconButton fontSize='large' onClick={()=>setChoosenAct('contacts')}>\r\n                <PeopleIcon  fontSize='large'  />\r\n              </IconButton>\r\n              <IconButton >\r\n                <MoreVertIcon />\r\n              </IconButton>\r\n            </div>\r\n          </div>\r\n         \r\n          {searchFlag?  \r\n          <div className='activeSearch' >\r\n            <div className='arrowButton'>\r\n              <IconButton onClick={()=>setSearchFlag(false)} >\r\n                <ArrowBackIcon fontSize='large' />\r\n              </IconButton>\r\n            </div>\r\n            <input className='searchBlock' type='text' onChange={handleChange}/> \r\n          </div>\r\n          :\r\n          <div className='searchBar'>\r\n            <div className='searchContainer' >\r\n              <SearchOutlined/>\r\n              <input placeholder='search' type='text' onClick={()=>setSearchFlag(true)}/>\r\n            </div>\r\n          </div>}\r\n           \r\n          {choosenAct==='contacts'?\r\n            <div>\r\n              <div className='sidebar_middle'>\r\n                <Button style={{fontSize:'10px'}} onClick={()=>openChoosenModal('NEW_CONTACT')}className='add_new_Button' >\r\n                  Add New Contact\r\n                </Button>\r\n              </div>\r\n              <div className='sidebar_bottom'>\r\n                <Contacts newConversationCallback={()=> setChoosenAct('conversations')}  openModalCallback={()=>openChoosenModal('NEW_GROUP')}/>\r\n              </div>\r\n            </div>\r\n            :   \r\n            <div className='sidebar_bottom'><Conversations/></div>}\r\n           \r\n            <Modal  className='Modal' open={modalOpen} onClose={closeModal} >\r\n              <div>\r\n                {choosenModal === 'NEW_GROUP' ? \r\n                <CreateNewGroup closeModal={closeModal}  /> :\r\n                <AddNewContact closeModal={closeModal} /> } \r\n              </div>\r\n            </Modal>\r\n        </div>}\r\n\r\n      </div>\r\n    )\r\n}\r\n","import React, { useState ,useEffect} from 'react'\r\nimport {useUser } from '../contexts/userprovider'\r\nimport {useConversations } from '../contexts/conversationsprovider'\r\nimport {Avatar,IconButton} from '@material-ui/core';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport '../css/addnew.css'\r\n\r\nfunction AddGroupMember({closeModal}) \r\n{\r\n\r\n    const [selectedContactsId, setSelectedContactsId] = useState([])\r\n    const {contacts,info } = useUser()\r\n    const {UpdateConversation,selectedConversation} = useConversations()\r\n    const [conversationContacts,setConversationContacts]=useState([])\r\n\r\n  \r\n    //save ids of group participants so they wont show in add to group list\r\n    useEffect(() =>\r\n    { \r\n        let ids=[]\r\n        selectedConversation.Participants.forEach((participant)=>\r\n        {\r\n           ids.push(participant.id)\r\n        }) \r\n        setConversationContacts(ids)\r\n\r\n    },[selectedConversation.Participants])\r\n\r\n    function AddMember()\r\n    {\r\n        let newParticipants= []\r\n        newParticipants=selectedConversation.Participants\r\n        let messages=selectedConversation.Messages\r\n        let message=''\r\n\r\n        //add choosen contacts to group participants\r\n        contacts.forEach(contact=>\r\n        {\r\n            if(selectedContactsId.includes(contact.id))\r\n            {\r\n                newParticipants.push(contact)\r\n                message={name:\"manager\",message: info.name +\" added \" + contact.name + \" to the group\",timeSent:'',containsImage:false,containsRecord:false,recordURL:null}\r\n                messages.push(message)\r\n            }\r\n\r\n        })\r\n\r\n        let updatedConversation={...selectedConversation,Participants:newParticipants,Messages:messages,LastMessage:message}\r\n        UpdateConversation(updatedConversation)\r\n        closeModal()\r\n\r\n    }\r\n\r\n    //on checkbox Click,if exists- remove from list,if not-add to list\r\n    function handleCheckboxChange(contactId) \r\n    {\r\n       \r\n        if(selectedContactsId.includes(contactId))\r\n        {\r\n            setSelectedContactsId(prevSelectedContactsId =>\r\n            {\r\n                return (prevSelectedContactsId.filter(id=> id!==contactId))\r\n            } )\r\n        }\r\n  \r\n        else\r\n        {\r\n           setSelectedContactsId(prevSelectedContactsId=>\r\n            {\r\n              return [...prevSelectedContactsId,contactId]\r\n            })\r\n        } \r\n\r\n    }\r\n\r\n    return (\r\n       <div className='add_new'>\r\n           <div className='add_new_group_border'>\r\n               <div className='new_conversation new_group'>\r\n                   <div style={{flex:'1'}} className='title_and_close'>\r\n                       <h2 className='add_contact_title' style={{marginLeft:'80px',paddingRight:'0px'}}>Select Members:</h2> \r\n                       <IconButton style={{marginLeft:'40px'}}className='close_add_new'  onClick={()=>closeModal()}>\r\n                          <CloseIcon fontSize='large' /> \r\n                       </IconButton>\r\n                   </div>\r\n                   <div style={{overflowY:'overlay',height:'200px'}}>\r\n                       {contacts.map(contact =>\r\n                       {\r\n                         //show only user contacts that are not in the group\r\n                         if(!(conversationContacts.includes(contact.id)))\r\n                         {\r\n                           return(\r\n                               <div className='contact_item' >\r\n                                   <input type=\"checkbox\" value={selectedContactsId.includes(contact.id)}\r\n                                    id={contact.id} onChange={() => handleCheckboxChange(contact.id)}/>\r\n                                   <label style={{display:'flex',flexDirection:'row',alignItems:'center',width:'100%'}}for={contact.id} >\r\n                                      <Avatar  style={{margin:'5px'}} src={process.env.PUBLIC_URL + contact.imageName}   fontSize='large'/>\r\n                                      <h3 className='enter_phone' style={{marginLeft:'10px' ,fontWeight:'400'}}>{contact.name} </h3>\r\n                                   </label>\r\n                               </div>\r\n                            )}\r\n\r\n                         else return ''\r\n            \r\n                        }) } \r\n             \r\n                   </div>\r\n                   <div style={{display:'flex' , justifyContent:'center'}}>\r\n                        <button className='add_new_button'  type=\"submit\" onClick={()=>AddMember()}>Add</button>\r\n                   </div>\r\n\r\n               </div>\r\n           </div>\r\n       </div>\r\n    )\r\n}\r\n\r\nexport default AddGroupMember\r\n","import React from 'react'\r\nimport '../css/sidebar.css'\r\nimport axios from 'axios';\r\nimport { useState,useEffect} from 'react'\r\nimport { useConversations } from '../contexts/conversationsprovider';\r\nimport { useUser } from '../contexts/userprovider';\r\nimport { Avatar ,IconButton,makeStyles,Modal} from '@material-ui/core'\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport CheckIcon from '@material-ui/icons/Check';\r\nimport InsertEmoticonIcon from '@material-ui/icons/InsertEmoticon';\r\nimport Picker from 'emoji-picker-react';\r\nimport PersonAdd from '@material-ui/icons/PersonAdd';\r\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\r\nimport AddGroupMember from './addgroupmember';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport AddAPhotoIcon from '@material-ui/icons/AddAPhoto';\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n      \"&:hover\": {\r\n        backgroundColor: \"transparent\"\r\n  \r\n      }}\r\n    });\r\n  \r\n\r\nfunction ShowGroupDetails() {\r\n\r\n    const {selectedConversation,createConversation,conversations,setSelectedConversation,UpdateConversation} = useConversations()\r\n    const [EditGroupNameGlag,setEditGroupNameGlag]=useState(false)\r\n    const [EditGroupDescriptionGlag,setEditGroupDescriptionGlag]=useState(false)\r\n    const [emojiFlag,setEmojiFlag]=useState(false)\r\n    const [Text,setText] = useState(selectedConversation.Name)\r\n    const [Description,setDescription] = useState(selectedConversation.description)\r\n    const {info} = useUser()\r\n    const classes = useStyles();\r\n    const [modalOpen, setModalOpen] = useState(false)\r\n    const [dialogOpen, setDialogOpen] = useState(false)\r\n    const [deleteUserDialog,setDeleteUserDialog]= useState(false)\r\n    const [userToDelete,setUserToDelete] = useState()\r\n    const [previewImage,setPreviewImage]=useState(selectedConversation.ConversationImage)\r\n\r\n\r\n       \r\n    useEffect(()=>\r\n    {\r\n        setEditGroupNameGlag(false)\r\n        setEditGroupDescriptionGlag(false)\r\n        setEmojiFlag(false)\r\n\r\n    },[selectedConversation])\r\n  \r\n  \r\n    const onEmojiClick = (event, emojiObject) =>\r\n    {\r\n        setText(Text + emojiObject.emoji)\r\n    };\r\n  \r\n    const onDescriptionEmojiClick = (event, emojiObject) =>\r\n    {\r\n        setDescription(Description + emojiObject.emoji)\r\n    };\r\n  \r\n    function changeGroupName()\r\n    {\r\n        let message={name:\"manager\",message: info.name +\" changed group name to \" + Text,timeSent:'',containsImage:false,containsRecord:false,recordURL:null}\r\n        let messages=selectedConversation.Messages\r\n        messages.push(message)\r\n        let updatedConversation={...selectedConversation,Name:Text,Messages:messages,LastMasage:message}\r\n        UpdateConversation(updatedConversation)\r\n        setEditGroupNameGlag(false)\r\n    }\r\n  \r\n    function openConversation(participant)\r\n    {\r\n        let existsFlag=false\r\n\r\n        conversations.forEach(conversation=>\r\n        {\r\n            if(conversation.isGroup === false && conversation.Participants[0].id === participant.id)\r\n            {\r\n              existsFlag=true\r\n              setSelectedConversation(conversation)\r\n            }\r\n              \r\n        })\r\n\r\n        if(!existsFlag)\r\n        {\r\n            let participantId=[]\r\n            participantId.push(participant.id)\r\n            createConversation(participantId, participant.name, participant.imageName,false)\r\n        }\r\n        \r\n    }\r\n  \r\n    function changeGroupDescription()\r\n    {\r\n         let message={name:\"manager\",message: info.name +\" changed group Description\",timeSent:'',containsImage:false,containsRecord:false,recordURL:null}\r\n         let messages=selectedConversation.Messages\r\n         messages.push(message)\r\n         let updatedConversation={...selectedConversation,description:Description,Messages:messages,LastMessage:message}\r\n         UpdateConversation(updatedConversation)\r\n         setEditGroupDescriptionGlag(false)\r\n    }\r\n  \r\n    function removeFromGroup()\r\n    {\r\n       let message={name:\"manager\",message: info.name +\" left the group\",timeSent:'',containsImage:false,containsRecord:false,recordURL:null}\r\n       let messages=selectedConversation.Messages\r\n       messages.push(message)\r\n       let updatedConversation={...selectedConversation,Messages:messages,LastMessage:message}\r\n       UpdateConversation(updatedConversation)\r\n       setDialogOpen(false)\r\n    }\r\n  \r\n    function beforeDeleteUser(participant)\r\n    {\r\n       setUserToDelete(participant)\r\n       setDeleteUserDialog(true)\r\n    }\r\n  \r\n    function removeUserFromGroup()\r\n    {\r\n       let messages=selectedConversation.Messages\r\n       let message={name:\"manager\",message: info.name +\" removed \" + userToDelete.name + \" from the group \",timeSent:'',containsImage:false,containsRecord:false,recordURL:null}\r\n       messages.push(message)\r\n       let participants= selectedConversation.Participants.filter(participant=> participant.id !== userToDelete.id)\r\n       let updatedConversation={...selectedConversation,Participants:participants,Messages:messages,LastMessage:message}\r\n       UpdateConversation(updatedConversation)\r\n       setUserToDelete()\r\n       setDeleteUserDialog(false)\r\n    }\r\n  \r\n    function closeModal()\r\n    {\r\n       setModalOpen(false)\r\n    }\r\n\r\n    async function handleFileUpload(e)\r\n    {\r\n       setPreviewImage(window.URL.createObjectURL(e.target.files[0]))\r\n        let picturePath=''\r\n    \r\n        const data = new FormData()\r\n        data.append('file',e.target.files[0])\r\n        data.append(\"upload_preset\",\"whatsApp_clone\")\r\n        data.append(\"cloud_name\",\"dsrgpqnyv\")\r\n       \r\n        try\r\n        {\r\n          let response = await axios.post(\"https://api.cloudinary.com/v1_1/dsrgpqnyv/image/upload\",data)\r\n          picturePath =response.data.url\r\n\r\n        }catch(err){console.log(err)}\r\n\r\n\r\n        let messages=selectedConversation.Messages\r\n        let message={name:\"manager\",message: info.name +\" changed group picture\",timeSent:'',containsImage:false,containsRecord:false,recordURL:null}\r\n        messages.push(message)\r\n        let updatedConversation={...selectedConversation,ConversationImage:picturePath,Messages:messages,LastMessage:message}    \r\n        UpdateConversation(updatedConversation)\r\n\r\n\r\n        \r\n    }\r\n\r\n\r\n    return (\r\n        <div>\r\n           <div className='user_info'>\r\n              <div className='change_group_image'> \r\n                 <Avatar  src={previewImage} style={{height: '150px', width: '150px' ,backgroundColor:'gray' ,margin:'15px',marginTop:'30px'}}> </Avatar>\r\n                 <div className='change_image_on_hover' style={{display:'flex',flexDirection:'column',alignItems:'center',position:'absolute',zIndex:'1',color:'white',curser:'pointer'}}>\r\n                    <AddAPhotoIcon  style={{height: '30px', width: '30px' ,color:'white'}}/>\r\n                    <input accept=\"image/*\" id=\"file\" type=\"file\" name=\"file\" onChange={handleFileUpload}/>\r\n                    <span style={{fontSize:'10px'}}>Change Picture </span>\r\n                 </div>\r\n              </div>\r\n              <span className='name_and_lastSeen'>\r\n                {EditGroupNameGlag?\r\n                   <div style={{display:'flex',flexDirection:'column'}}>\r\n                     {emojiFlag?  <Picker onEmojiClick={(e,emojiObject)=>onEmojiClick(e,emojiObject)} pickerStyle={{ width: '100%' ,height:'200px'}}/> : ''}\r\n                     <div className='edit_group_name'>\r\n                        <IconButton className={classes.root} style={{padding:'3px'}} onClick={()=>changeGroupName()}>\r\n                           <CheckIcon fontSize='large'/>\r\n                        </IconButton>\r\n                        <IconButton className={classes.root} style={{padding:'3px'}} onClick={()=>setEmojiFlag(!emojiFlag)}>\r\n                            <InsertEmoticonIcon fontSize='large'/>\r\n                        </IconButton>\r\n                       <input className='input_text' defaultValue={Text} onChange={(e)=>setText(e.target.value)}></input>\r\n                     </div>\r\n                  </div>:\r\n                  <span className='group_title'>\r\n                     <h3>{selectedConversation.Name}</h3>\r\n                     <IconButton onClick={()=>setEditGroupNameGlag(true)}>\r\n                         <EditIcon style={{fontSize:'large',marginLeft:'10px'}}/>\r\n                     </IconButton>\r\n                  </span>}\r\n                \r\n                 <span className='lastSeen' style={{padding:'10px',paddingLeft:'0px'}}> created at:  {selectedConversation.createdDate} </span>\r\n              </span>\r\n            </div>\r\n\r\n            <div className='group_details_container'>\r\n               <h2 className='group_title' style={{padding:'5px'}}> Description </h2>\r\n              {EditGroupDescriptionGlag?\r\n                <div style={{display:'flex',flexDirection:'column'}}>\r\n                  {emojiFlag?  <Picker onEmojiClick={(e,emojiObject)=>onDescriptionEmojiClick(e,emojiObject)} pickerStyle={{ width: '100%' ,height:'200px'}}/> : ''}\r\n                  <div className='edit_group_name' style={{padding:'5px'}}>\r\n                    <IconButton className={classes.root} style={{padding:'3px'}} onClick={()=>changeGroupDescription()}>\r\n                        <CheckIcon fontSize='large'/>\r\n                     </IconButton>\r\n                    <IconButton className={classes.root} style={{padding:'3px'}} onClick={()=>setEmojiFlag(!emojiFlag)}><InsertEmoticonIcon fontSize='large'/></IconButton>\r\n                    <input className='input_text' defaultValue={Description} onChange={(e)=>setDescription(e.target.value)} ></input>\r\n                  </div>\r\n                </div>:\r\n                <div className='group_description_edit'>\r\n                  <span style={{fontSize:'15px',marginRight:'5px'}}>\r\n                      {selectedConversation.description}\r\n                  </span>\r\n                  <IconButton onClick={()=>setEditGroupDescriptionGlag(true)}>\r\n                      <EditIcon style={{fontSize:'large'}}/>\r\n                  </IconButton>\r\n                </div>}\r\n             \r\n            </div>\r\n\r\n            <div className='group_details_container'>\r\n               <h2 className='group_title' style={{ padding:'10px' ,borderBottom:'1px solid #B0B0B0'}}>\r\n                   {selectedConversation.Participants.length +1} participants\r\n               </h2>\r\n               <Modal className='Modal' open={modalOpen} onClose={closeModal} >\r\n                  <AddGroupMember closeModal={closeModal}  /> \r\n               </Modal>\r\n\r\n               {selectedConversation.creatorId===sessionStorage['id']?\r\n                   <div className='participant' style={{cursor:'pointer',fontSize:'15px'}} onClick={()=>setModalOpen(true)} >\r\n                      <Avatar>\r\n                         <IconButton className={classes.root} style={{padding:'3px'}}>\r\n                            <PersonAdd fontSize='large'/>\r\n                         </IconButton>\r\n                      </Avatar>\r\n                      <h3 className='group_participant_name'>Add Member</h3>\r\n                   </div>:''}\r\n\r\n               {selectedConversation.Participants.map((participant,index)=>\r\n               {\r\n                  return(\r\n                   <div  key={index} className='participant' >\r\n                     <div onClick={()=>openConversation(participant)} style={{display:'flex',flexGrow:'1',flexDirection:'row',alignItems:'center',cursor:'pointer'}}>\r\n                         <Avatar src={participant.imageName}/>\r\n                         <div  style={{display:'flex',flexGrow:'1',flexDirection:'row',alignItems:'center'}}>\r\n                           <h3 className='group_participant_name'>{participant.name}</h3>\r\n                           {participant.id===selectedConversation.creatorId?\r\n                             <div className='group_admin'>\r\n                                <h3 style={{fontSize:'13px'}}>Group Manager</h3>\r\n                             </div>\r\n                           :''}\r\n                         </div >\r\n                     </div>\r\n                     {sessionStorage['id'] === selectedConversation.creatorId?\r\n                        <IconButton  onClick={()=>beforeDeleteUser(participant)} style={{padding:'3px'}}>\r\n                          <CloseIcon fontSize='medium'/>\r\n                        </IconButton>\r\n                     :''}\r\n                   </div>)\r\n                })}\r\n\r\n                <div  className='participant'>\r\n                   <div style={{display:'flex',flexGrow:'1',flexDirection:'row',alignItems:'center'}}>\r\n                     <Avatar src={info.imageName}/>\r\n                     <div style={{display:'flex',flexGrow:'1',flexDirection:'row',alignItems:'center'}}>\r\n                         <h3 className='group_participant_name'>{info.name}</h3>\r\n                         {sessionStorage['id']===selectedConversation.creatorId?\r\n                           <div className='group_admin'>\r\n                               <h3 style={{fontSize:'13px'}}>Group Manager</h3>\r\n                           </div>\r\n                          :''}\r\n                     </div >\r\n                   </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className='group_details_container leave' onClick={()=>setDialogOpen(true)} >\r\n                <div className='leaveGroup'>\r\n                    <IconButton className={classes.root} style={{padding:'3px'}} >\r\n                      <ExitToAppIcon style={{color:'darkred'}}fontSize='large'/>\r\n                    </IconButton>\r\n                     <h3 className='group_participant_name' style={{color:'darkRed',fontSize:'17px'}}>leave Group</h3>\r\n                </div>\r\n            </div>\r\n\r\n            <Dialog className='exit_group_dialog' onClose={()=> setDialogOpen(false)}  open={dialogOpen}>\r\n               <div style={{padding:'10px'}}>\r\n                 <h2 className='dialog_title'> are you sure you want to leave this group?</h2>\r\n                 <div className='dialog_options_buttons'>\r\n                   <button className='dialog_button' onClick={()=>removeFromGroup()} >yes</button>\r\n                   <button className='dialog_button' onClick={()=>setDialogOpen(false)}>no</button>\r\n                 </div>\r\n                </div>\r\n            </Dialog>\r\n\r\n\r\n            <Dialog className='exit_group_dialog' onClose={()=> setDeleteUserDialog(false)}  open={deleteUserDialog}>\r\n               <div style={{padding:'10px'}}>\r\n                 <h2 className='dialog_title'> are you sure you want to delete this user?</h2>\r\n                 <div className='dialog_options_buttons'>\r\n                   <button className='dialog_button' onClick={()=>removeUserFromGroup()} >yes</button>\r\n                   <button className='dialog_button' onClick={()=>setDeleteUserDialog(false)}>no</button>\r\n                 </div>\r\n                </div>\r\n            </Dialog>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ShowGroupDetails\r\n","import React from 'react'\r\nimport {useState} from 'react'\r\nimport {useConversations } from '../contexts/conversationsprovider';\r\nimport {Avatar} from '@material-ui/core'\r\nimport Dialog from '@material-ui/core/Dialog';\r\n\r\nfunction ShowUserDetails({privateConversationHeader}) {\r\n\r\n    const {selectedConversation} = useConversations()\r\n    const [pictureDialogOpen,setPictureDialogOpen]=useState(false)\r\n\r\n\r\n    return (\r\n\r\n        <div className='user_info'>\r\n           <div onClick={()=>setPictureDialogOpen(true)}>\r\n               <Avatar  src={selectedConversation.Participants[0].imageName} style={{margin:'20px',height:'150px',width:'150px'}}/>\r\n           </div>\r\n\r\n           <Dialog className='open_picture_dialog' onClose={()=> setPictureDialogOpen(false)}  open={pictureDialogOpen}>\r\n              <img src={selectedConversation.ConversationImage} alt=''/>\r\n           </Dialog>\r\n\r\n     \r\n           <span className='name_and_lastSeen' style={{paddingBottom:'0px'}}>\r\n              {console.log('here')}\r\n              <span className='group_title'>\r\n                 <h3>{selectedConversation.Name}</h3>\r\n              </span>\r\n     \r\n              <span className='lastSeen' style={{padding:'10px',paddingLeft:'0px'}}>\r\n                  {privateConversationHeader()}\r\n              </span>\r\n           </span>\r\n       \r\n      </div>\r\n\r\n    )\r\n}\r\n\r\nexport default ShowUserDetails\r\n","import {useState} from 'react'\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport {useConversations} from '../contexts/conversationsprovider'\r\n\r\nfunction Message({sender,message}) \r\n{\r\n  const [modalOpen,setModalOpen] = useState(false)\r\n  const [SelectedImageURL,setSelectedImageURL] =useState(null)\r\n  const {selectedConversation} = useConversations()\r\n\r\n  function openImage(URL)\r\n  {\r\n    setModalOpen(true)\r\n    setSelectedImageURL(URL)  \r\n  }\r\n\r\n\r\n  return (\r\n\r\n    <div className={sender}>  \r\n      <div className='message' >\r\n        <div className='image_and_sender'>\r\n\r\n          {selectedConversation.isGroup?\r\n          <div className='sender' style={{color:message.color}} >\r\n             {message.name} \r\n          </div>\r\n          :\r\n          <div className='sender' >\r\n          {message.name} \r\n          </div>}\r\n\r\n          {message.containsImage? \r\n          <img className='image_in_message' src={message.imageURL} alt='' onClick={()=>openImage(message.imageURL)} width='200px' height='200px' /> \r\n           : ''}\r\n        </div>\r\n        <div>\r\n          <div className='message_and_time'>\r\n            <div className='message_content'  >{message.message}</div> \r\n            <div className='message_time_border'>\r\n              <div className='message_time'>\r\n                {(message.timeSent).substring(11,17)}\r\n              </div>\r\n            </div>\r\n          </div> \r\n        </div>\r\n\r\n        <Dialog onClose={()=> setModalOpen(false)}  open={modalOpen}>\r\n          <img src={SelectedImageURL} alt=''/>\r\n        </Dialog>\r\n      </div>\r\n    </div> \r\n  )}\r\n\r\nexport default Message\r\n\r\n","import React from 'react'\r\nimport { Avatar } from '@material-ui/core'\r\nimport '../css/audiomessage.css'\r\n\r\nfunction AudioMessage({message,sender,image})\r\n{\r\n\r\n  const messageColor = sender.includes('chat_reciever')?  'reciever':'sender' \r\n\r\n  return (\r\n    \r\n    <div className={sender}>  \r\n      <div className='message_with_audio'>\r\n        <div className={messageColor}>\r\n            {sender === \"message_out\"?\r\n            <div className='audio_and_avatar'> \r\n                <audio   controls controlsList=\"nodownload\" >\r\n                  <source src={message.recordURL} type=\"audio/mp3\"/>\r\n                </audio>\r\n                <Avatar src={image} style={{ height: '50px', width: '50px',margin:'5px' }}/>\r\n            </div>\r\n               :\r\n            <div className='audio_and_avatar'> \r\n                <Avatar src={image} style={{ height: '50px', width: '50px',margin:'5px' }}/>\r\n                <audio   controls controlsList=\"nodownload\" >\r\n                  <source src={message.recordURL} type=\"audio/mp3\"/>\r\n                </audio>\r\n            </div>}\r\n            <span className='message_time'>{(message.timeSent).substring(11,17)}</span> \r\n        </div>\r\n      </div>\r\n    </div>\r\n    )\r\n}\r\n\r\nexport default AudioMessage\r\n","import React from 'react'\r\nimport {useState ,useCallback,useEffect,useRef} from 'react'\r\nimport {useConversations} from '../contexts/conversationsprovider';\r\nimport {useSocket} from '../contexts/socketprovider';\r\nimport {useUser} from '../contexts/userprovider';\r\nimport {IconButton,Dialog } from '@material-ui/core'\r\nimport InsertEmoticonIcon from '@material-ui/icons/InsertEmoticon';\r\nimport MicIcon from '@material-ui/icons/Mic';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport ImageIcon from '@material-ui/icons/Image';\r\nimport CheckIcon from '@material-ui/icons/Check';\r\nimport Picker from 'emoji-picker-react';\r\nimport { useReactMediaRecorder } from \"react-media-recorder\";\r\nimport axios from 'axios'\r\nimport Message from './message';\r\nimport AudioMessage from './audiomessage';\r\n\r\n\r\nfunction ChatBody(props) {\r\n\r\n  const [Text,setText] = useState('')\r\n  const {socket} = useSocket()\r\n  const {info} = useUser()\r\n  const {sendMessage,selectedConversation,removedFromGroupFlag,setRemovedFromGroupFlag,setSelectedConversation} = useConversations()\r\n  const inputRef = useRef(null)\r\n  const [emojiFlag,setEmojiFlag] = useState(false)\r\n  const [recordFlag,setRecordFlag] =useState(false)\r\n  const {startRecording,stopRecording,mediaBlobUrl,clearBlobUrl} = useReactMediaRecorder({audio: true })\r\n  const [audioBlob,setAudioBlob] = useState(null)\r\n\r\n  //make messages scrolling down when message sent\r\n  const setRef = useCallback((node) => \r\n  {\r\n    if(node)\r\n      node.scrollIntoView({smooth:true})\r\n\r\n  },[])\r\n  \r\n  useEffect(()=>\r\n  {\r\n    setEmojiFlag(false)\r\n\r\n  },[selectedConversation])\r\n\r\n  \r\n\r\n  //when audio message sent, upload it to cloudinary and send it to conversation participants\r\n  useEffect( () => \r\n  {\r\n\r\n    async function fetchData() \r\n    {\r\n      if(audioBlob != null)\r\n      {\r\n        let audio= await fetch(mediaBlobUrl).then(res=> res.blob())\r\n        const data = new FormData();\r\n           \r\n        data.append('file', audio);\r\n        data.append('resource_type', 'video');\r\n        data.append(\"upload_preset\",\"whatsApp_clone\")\r\n        data.append(\"cloud_name\",\"dsrgpqnyv\")\r\n\r\n\r\n        try\r\n        {\r\n          let response = await axios.post(\"https://api.cloudinary.com/v1_1/dsrgpqnyv/video/upload\",data)\r\n          let recordURL = response.data.url\r\n          recordURL=(recordURL.slice(0,-4))\r\n          recordURL+= 'mp3'\r\n          setRecordFlag(false)\r\n          clearBlobUrl()\r\n          sendMessage(Text,null,null,recordURL)\r\n          setRecordFlag(false)\r\n  \r\n        }catch(err){console.log(err)}\r\n      }\r\n    }\r\n\r\n    fetchData();\r\n \r\n  },[audioBlob])\r\n\r\n\r\n  //when typing, let conversation participants know\r\n  function typing(e)\r\n  {\r\n\r\n    setText(e.target.value)\r\n    if (socket.current == null) return;\r\n      socket.current.emit(\"typing\", {user:info,Conversation:selectedConversation})\r\n\r\n  }\r\n\r\n\r\n  //send message to conversation participants\r\n  function handleSubmit(e)\r\n  {\r\n    e.preventDefault()\r\n    sendMessage(Text,false,null,null)\r\n    setText(' ')\r\n\r\n  }\r\n\r\n\r\n  //upload image to cloudinary\r\n  async function handleImage(e)\r\n  {\r\n\r\n    const data = new FormData()\r\n    data.append('file',e.target.files[0])\r\n    data.append(\"upload_preset\",\"whatsApp_clone\")\r\n    data.append(\"cloud_name\",\"dsrgpqnyv\")\r\n    try\r\n    {\r\n\r\n      let response = await axios.post(\"https://api.cloudinary.com/v1_1/dsrgpqnyv/image/upload\",data)\r\n      props.imageCallback(response.data.url)\r\n      }catch(err){console.log(err)}\r\n\r\n    }\r\n\r\n\r\n  //when record start\r\n  function recordStart()\r\n  {\r\n\r\n    setRecordFlag(true)\r\n    startRecording()\r\n\r\n  }\r\n \r\n  //when record sent\r\n  async function handleRecord()\r\n  {\r\n    stopRecording()\r\n    let res = await fetch(mediaBlobUrl)\r\n    setAudioBlob(res.blob())     \r\n  }\r\n\r\n\r\n  //when record canceled\r\n  function cancelRecord()\r\n  {\r\n    stopRecording()\r\n    clearBlobUrl()\r\n    setRecordFlag(false)\r\n  }\r\n\r\n\r\n  //when recording, show recording div\r\n  function updateRecordingDiv()\r\n  {\r\n    let recordDiv = \r\n    <div>\r\n      <IconButton>\r\n        <CloseIcon fontSize='large' style={{color:'red'}} onClick={cancelRecord} />\r\n      </IconButton>\r\n      <IconButton>\r\n        <CheckIcon fontSize='large'style={{color:'green'}} onClick={handleRecord} />\r\n      </IconButton>\r\n    </div>\r\n\r\n    return recordDiv\r\n  \r\n  }\r\n\r\n  //if removed from group when group chat is on, dont show this group chat\r\n  function handleRemovedFromGroup()\r\n  {\r\n\r\n    setRemovedFromGroupFlag(false)\r\n    setSelectedConversation()\r\n\r\n  }\r\n    \r\n\r\n  //add emoji to message\r\n  const onEmojiClick = (event, emojiObject) => \r\n  {\r\n    setText(Text + emojiObject.emoji)\r\n  };\r\n\r\n\r\n\r\n  return(\r\n\r\n    <div className= 'body_and_footer'>\r\n        <div className='chat_body'>\r\n\r\n          {selectedConversation.Messages.map((message,index)=>\r\n          {\r\n            const lastMessage = selectedConversation.Messages.length -1 === index\r\n            let sender= ''\r\n            sender= message.name==='manager'? 'manager':( message.id===sessionStorage['id']? 'message_out' : 'message_in')\r\n            let image=message.id===sessionStorage['id']? info.imageName :selectedConversation.ConversationImage\r\n            let choosenClass = sender==='message_in'? 'chat_message chat_sender': ' chat_message chat_reciever'\r\n\r\n            return (\r\n              <div key={index}>\r\n                {sender === 'manager'?\r\n                <div className='around_message'ref={lastMessage ? setRef : null}>\r\n                  <div className='manager_message'>\r\n                     <span className='message_content'>{message.message}</span>\r\n                  </div>\r\n                </div>\r\n                :\r\n                <div key={index} className={choosenClass} ref={lastMessage ? setRef : null}>\r\n                  {message.containsRecord ? \r\n                  <AudioMessage message={message} sender={sender} image={image}/> : <Message  sender={sender} message={message}/>}\r\n                </div> }\r\n              </div>\r\n            )}\r\n          )}\r\n\r\n        </div>\r\n\r\n        <div className='chat_footer_with_stickers'>\r\n           {emojiFlag?  <Picker onEmojiClick={(e,emojiObject)=>onEmojiClick(e,emojiObject)} pickerStyle={{ width: '100%' }}/>: ''}\r\n            <div className='chat_footer'>\r\n              {emojiFlag? <IconButton  onClick={()=>setEmojiFlag(false)}><CloseIcon fontSize='large'/> </IconButton>:''}\r\n              <IconButton  onClick={()=>setEmojiFlag(true)}>\r\n                 <InsertEmoticonIcon fontSize='large'/>\r\n              </IconButton>\r\n              <input accept=\"image/*\" className='invisibleInput' id=\"icon-button-file\" type=\"file\"  style={{ visibility: 'hidden'}} onChange={handleImage}/>\r\n              <label htmlFor=\"icon-button-file\">\r\n                <IconButton component=\"span\">\r\n                  <ImageIcon  fontSize='large'/>\r\n                </IconButton>\r\n              </label> \r\n              <form onSubmit={handleSubmit} className='message_section'>\r\n                 <input className='message_input' ref={inputRef}  value={Text} onChange={typing} type='text' placeholder='type a message'/>\r\n                 <button type='submit' > send </button>\r\n              </form>\r\n              {recordFlag? updateRecordingDiv() :   \r\n              <IconButton onClick={recordStart}>\r\n                <MicIcon fontSize='large'  />\r\n              </IconButton>}\r\n            </div>\r\n        </div>\r\n        <Dialog className='exit_group_dialog'  open={removedFromGroupFlag}>\r\n          <div style={{padding:'10px'}}>\r\n            <h2 className='dialog_title'> you where removed from this group</h2>\r\n              <div className='dialog_options_buttons'>\r\n                <button className='dialog_button' onClick={()=>handleRemovedFromGroup()} >ok</button>\r\n              </div>\r\n          </div>\r\n        </Dialog> \r\n\r\n    </div>    \r\n)}\r\n\r\nexport default ChatBody\r\n","import '../css/chat.css'\r\nimport '../css/sendimagebody.css'\r\nimport React, { useRef } from 'react'\r\nimport {useState} from 'react'\r\nimport {useConversations } from '../contexts/conversationsprovider';\r\nimport {useSocket} from '../contexts/socketprovider';\r\nimport {useUser} from '../contexts/userprovider';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport {IconButton } from '@material-ui/core'\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\n\r\nfunction SendImageBody(props) \r\n{\r\n\r\n  const inputRef = useRef(null)\r\n  const [Text,setText] = useState('')\r\n  const {socket} = useSocket()\r\n  const {info} = useUser()\r\n  const {sendMessage,selectedConversation} = useConversations()\r\n\r\n  function handleSubmit(imageFlag)\r\n  {\r\n\r\n    if(imageFlag===true)\r\n      sendMessage(Text,true,props.imageURL)\r\n\r\n    setText(' ')\r\n    props.backToChat()\r\n\r\n  }\r\n\r\n  function typing(e)\r\n  {\r\n\r\n    setText(e.target.value)\r\n\r\n    if (socket.current == null) return;\r\n      socket.current.emit(\"typing\", {user:info,Conversation:selectedConversation})\r\n\r\n  }\r\n\r\n    return (\r\n      <div className='SendImage'>\r\n        <div className='sendImageHeader'></div>\r\n          <IconButton type='submit' onClick={()=>handleSubmit(false)}>\r\n            <CloseIcon fontSize='large' /> \r\n          </IconButton>\r\n          <img src= {props.imageURL} alt='' height='300px' width='300px'/>\r\n          <div className='add_message'>\r\n            <form onSubmit={()=>handleSubmit(true)} className='message_section'>\r\n              <IconButton type='submit' style={{flex:'0.1'}}>\r\n                <SendIcon fontSize='large'/>\r\n              </IconButton>\r\n              <input className='message_input' ref={inputRef}  value={Text} onChange={typing} type='text' placeholder='type a message'/>\r\n            </form>\r\n          </div>\r\n      </div>\r\n    )\r\n}\r\n\r\nexport default SendImageBody\r\n","import '../css/chat.css'\r\nimport '../css/sidebar.css'\r\nimport React from 'react'\r\nimport ShowGroupDetails from './showgroupdetails'\r\nimport ShowUserDetails from './showuserdetails'\r\nimport { useState} from 'react'\r\nimport { useConversations } from '../contexts/conversationsprovider';\r\nimport { Avatar ,IconButton} from '@material-ui/core'\r\nimport ChatBody from './chatbody';\r\nimport SendImageBody from './sendimagebody';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nexport default function Chat() \r\n{\r\n\r\n  const {selectedConversation,currentConversationIsConnected,typingFlag,setTypingFlag,showDetails,setShowDetails} = useConversations()\r\n  const [imageFlag,setImageFlag] =useState(false)\r\n  const [imageURL,setImageURL] =useState(false)\r\n\r\n  //check if user is connected/disconnected/typing\r\n  const privateConversationHeader = () =>\r\n  {\r\n  \r\n    let returnValue = ''\r\n    if(currentConversationIsConnected === '')\r\n    {\r\n\r\n      if(typingFlag !== '')\r\n      {\r\n        returnValue = <div className='lastSeen'> typing...</div>\r\n        setTimeout(()=> setTypingFlag(''),1000)\r\n      }\r\n  \r\n      else returnValue = <div className='connected'><div className='circle'></div> online </div>\r\n              \r\n    }\r\n  \r\n    else returnValue = <div className='lastSeen'>{currentConversationIsConnected}</div>\r\n  \r\n  \r\n    return returnValue\r\n  \r\n  }\r\n\r\n  const groupheader = () =>\r\n  {\r\n\r\n    let returnValue = ''\r\n    if(typingFlag !== '')\r\n    {\r\n      returnValue = <div className='lastSeen'> {typingFlag} is typing...</div>\r\n      setTimeout(()=> setTypingFlag(''),1000)\r\n    }\r\n\r\n    else\r\n    {\r\n\r\n      let UsersInGroup = ''\r\n\r\n      selectedConversation.Participants.forEach((participant,index)=> \r\n      {\r\n        if(index ===  selectedConversation.Participants.length-1 )\r\n          UsersInGroup = UsersInGroup + participant.name\r\n        else\r\n          UsersInGroup= UsersInGroup + participant.name + ', '\r\n      })\r\n            \r\n      returnValue=  <div className='lastSeen'>{UsersInGroup} </div>\r\n\r\n    }\r\n\r\n    return returnValue\r\n  }\r\n\r\n  function chatBodyCallback(image)\r\n  {\r\n    setImageURL(image)\r\n    setImageFlag(true)\r\n  }\r\n\r\n  function backToChatCallback()\r\n  {\r\n    setImageURL(null)\r\n    setImageFlag(false)\r\n  }\r\n\r\n\r\n  const chatSide=\r\n    <div>\r\n      <div className='chat_header' onClick={()=>setShowDetails(true)}>\r\n        {selectedConversation.isGroup?\r\n        <Avatar src={selectedConversation.ConversationImage}/>:<Avatar src={selectedConversation.Participants[0].imageName}/>}\r\n        <div className='chat_header_info'>\r\n          <h2 style={{fontSize:'20px'}}> {selectedConversation.Name} </h2> \r\n          {selectedConversation.isGroup?  groupheader() : privateConversationHeader()}\r\n        </div>\r\n      </div>\r\n      {imageFlag? <SendImageBody imageURL={imageURL} backToChat={backToChatCallback}/>:<ChatBody imageCallback={chatBodyCallback}/>} \r\n    </div>\r\n\r\n\r\n  return (\r\n       \r\n    showDetails?\r\n      <div className='chat_with_details'>\r\n        <div className='chat narrow_chat'>\r\n          {chatSide}\r\n        </div>\r\n\r\n        <div className='chat_details'>\r\n          <div className='chat_details_top '>\r\n            <IconButton onClick={()=>setShowDetails(false)}>\r\n              <CloseIcon fontSize='large'  />\r\n            </IconButton>\r\n            <h2 style={{paddingLeft:'10px',fontSize:'22px'}}>{selectedConversation.isGroup? 'Group Details:' : 'Contact Details:' }</h2>\r\n          </div>\r\n\r\n          <span className='chat_details_body'>\r\n              {selectedConversation.isGroup? <ShowGroupDetails/>: <ShowUserDetails privateConversationHeader={privateConversationHeader}/>}\r\n          </span>\r\n        </div>\r\n      </div>\r\n      :\r\n      <div className='chat'>\r\n        {chatSide}\r\n      </div>\r\n\r\n          \r\n    )\r\n}\r\n","import '../css/dashboard.css'\r\nimport React from 'react'\r\nimport SideBar from './sidebar'\r\nimport Chat from './chat'\r\nimport { useConversations } from '../contexts/conversationsprovider'\r\nimport { withRouter } from 'react-router-dom'\r\n\r\nexport default withRouter(function Dashboard({id}) {\r\n    const {selectedConversation} =useConversations()\r\n\r\n    return (\r\n        <div className='dashboard'>\r\n            <div className='dashboard_body'>\r\n              <SideBar/>\r\n              {selectedConversation!==undefined?  <Chat id={id}  />: ''}\r\n            </div>\r\n        </div>\r\n    )\r\n})\r\n","import {useState} from 'react'\r\nimport '../css/login.css'\r\nimport axios from 'axios'\r\nimport {Link,useHistory} from 'react-router-dom'\r\nimport 'font-awesome/css/font-awesome.min.css';\r\nimport {Avatar} from '@material-ui/core';\r\nimport AddAPhotoIcon from '@material-ui/icons/AddAPhoto';\r\nimport PeopleAltIcon from '@material-ui/icons/PeopleAlt';\r\n\r\n \r\n\r\nfunction Register(props)\r\n{\r\n\r\n  const[phone,setPhone] =useState('')\r\n  const[name,setName] =useState('')\r\n  const [Picture,setPicture] =useState(null)\r\n  const history=useHistory();\r\n  const [error,setError] =useState('')\r\n  const [previewImage,setPreviewImage]=useState()\r\n\r\n  \r\n  function getColor()\r\n  {\r\n    return ('#'+(Math.random()*0xFFFFFF<<0).toString(16))\r\n  }\r\n\r\n  //get user information and token from DB\r\n  async function handleSubmit(e)\r\n  {\r\n    e.preventDefault();\r\n        \r\n    let picturePath=''\r\n\r\n    if(Picture)\r\n    {\r\n      const data = new FormData()\r\n      data.append('file',Picture)\r\n      data.append(\"upload_preset\",\"whatsApp_clone\")\r\n      data.append(\"cloud_name\",\"dsrgpqnyv\")\r\n       \r\n      try\r\n      {\r\n        let response = await axios.post(\"https://api.cloudinary.com/v1_1/dsrgpqnyv/image/upload\",data)\r\n        picturePath =response.data.url\r\n\r\n      }catch(err){console.log(err)}\r\n\r\n    }\r\n\r\n  \r\n    let randomColor=getColor()  \r\n    let obj = {name:name,phone:phone,imageName:picturePath,contacts:[],LastSeen:'last seen at...',Status:\"hello,i'm using Message-App!\",color:randomColor}\r\n\r\n\r\n    try{\r\n         const response = await axios.post(\"https://messagesapp1.herokuapp.com/api/logIn/Register\",obj)\r\n         if(response.data.status === 'error')\r\n         {\r\n            setError(response.data.message)\r\n         }\r\n\r\n         else\r\n          {\r\n            sessionStorage['config']= response.data.token \r\n            sessionStorage['id'] = response.data.User._id\r\n            sessionStorage['name'] = response.data.User.name\r\n            props.CanLogIn(response.data.User._id)\r\n\r\n            history.push('/App')\r\n          }\r\n        }catch(err){console.log(err)}     \r\n  }\r\n        \r\n\r\n  function handleFileUpload(e) \r\n  {\r\n\r\n    setPicture(e.target.files[0])\r\n    setPreviewImage(window.URL.createObjectURL(e.target.files[0]))\r\n\r\n  }\r\n\r\n  return (\r\n\r\n    <div className=\"overlay\">\r\n      <form className='login_form' onSubmit={handleSubmit}>\r\n         <div className=\"con\">\r\n            <header className=\"head-form\"  style={{marginBottom:'0px', paddingBottom:'0px'}}>\r\n              <h2>Register</h2>\r\n              <p>welcome to  my whatsApp</p>\r\n            </header>\r\n            <div className=\"field-set\">\r\n             {previewImage?\r\n               <div className='change_group_image'> \r\n                    <Avatar  src={previewImage} style={{height: '140px', width: '140px' ,backgroundColor:'gray' ,margin:'15px',marginTop:'30px'}}> </Avatar>\r\n                    <div className='change_image_on_hover' style={{display:'flex',flexDirection:'column',alignItems:'center',position:'absolute',zIndex:'1',color:'white',curser:'pointer'}}>\r\n                      <AddAPhotoIcon  style={{height: '30px', width: '30px' ,color:'white'}}/>\r\n                      <input accept=\"image/*\" id=\"file\" type=\"file\" name=\"file\" onChange={handleFileUpload}/>\r\n                      <span style={{fontSize:'10px'}}>Change Picture </span>\r\n                    </div>\r\n                </div>\r\n           \r\n              :\r\n              <div className='add_Profile_Picture'>\r\n                <Avatar   style={{height: '140px', width: '140px' ,backgroundColor:'gray' ,margin:'15px',marginTop:'30px'}}>\r\n                  <PeopleAltIcon style={{position:'absolute',zIndex:'0', opacity:'0.1',height: '80px', width: '80px' }}/>\r\n                  <div  style={{display:'flex',flexDirection:'column',alignItems:'center',position:'absolute',zIndex:'1',color:'white',curser:'pointer'}}>\r\n                    <AddAPhotoIcon  style={{height: '30px', width: '30px' ,color:'white'}}/>\r\n                    <input accept=\"image/*\" id=\"file\" type=\"file\" name=\"file\" onChange={handleFileUpload}/>\r\n                    <span style={{fontSize:'10px'}}>Add Profile Picture</span>\r\n                  </div>\r\n                </Avatar>\r\n              </div> }\r\n              <span className=\"input-item\">\r\n                <i class=\"fa fa-user-circle\"></i>\r\n                <input className=\"form-input\" id=\"txt-input\" type=\"text\" placeholder=\"@UserName\" onChange={(e)=> setName(e.target.value)} required />\r\n              </span>\r\n              <span className=\"input-item\">\r\n                <i class=\"fa fa-key\"></i>\r\n                <input className=\"form-input\" type=\"password\" placeholder=\"Password\" id=\"pwd\"  name=\"password\" onChange={(e)=> setPhone(e.target.value)} required/>\r\n              </span>\r\n              <button className=\"log-in\" type='submit'> Register </button>\r\n            </div>\r\n            <div>\r\n              <Link  className=\"submits sign-up defaultLink\" to={`/`}>    <i style={{margin:'7px'}}class=\"fa fa-user-plus\" aria-hidden=\"true\"/>back to Log In</Link>\r\n            </div>\r\n            <span style={{fontSize:'15px'}}>{error}</span>\r\n          </div>\r\n      </form>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport default Register\r\n","import {useState} from 'react'\nimport LogIn from './login'\nimport Dashboard from './dashboard'\nimport {UserProvider} from '../contexts/userprovider'\nimport {ConversationsProvider} from '../contexts/conversationsprovider'\nimport { SocketProvider } from '../contexts/socketprovider'\nimport {BrowserRouter as Router,Switch, Route,Redirect} from 'react-router-dom'\nimport Register from './register'\nimport '../css/app.css'\n\n\nfunction App() \n{\n\n  const [id,setId] =useState()\n\n  const dashboard = (\n   <SocketProvider userId={id} >\n     <UserProvider id={id}>\n      <ConversationsProvider >\n        <Dashboard  id={id}/>\n      </ConversationsProvider>\n     </UserProvider>\n    </SocketProvider>\n  )\n\n  return (\n\n    <Router >\n      <div className=\"App\">\n         <Switch>\n           {sessionStorage['id']}\n            <Route exact path='/' > <LogIn CanLogIn={setId}/></Route> \n            <Route path='/Register' > <Register CanLogIn={setId}/></Route>\n            {sessionStorage['id']?  <Route exact path='/App' > {dashboard} </Route>:<Redirect to=\"/\" />}\n         </Switch>\n  \n      </div>\n\n    </Router>\n  );\n}\n\nexport default App;\n","import React from 'react';\n\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}